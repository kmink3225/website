---
title: "Environment Setting for Airflow"
subtitle: WSL, Docker Installment, Airflow Installment, Development Environment Setting, Python Interpreter Installment, VScode Installment, Git Evnvironment Setting, Airflow Library Installment
description: |
  template
categories:
  - Engineering
author: Kwangmin Kim
date: 05/01/2023
format: 
  html:
    page-layout: full
    code-fold: true
    toc: true
    number-sections: true
comments: 
  utterances: 
    repo: ./docs/comments
draft: False
---

<ul class="nav nav-pills" id="language-tab" role="tablist">
  <li class="nav-item" role="presentation">
    <button class="nav-link active" id="Korean-tab" data-bs-toggle="tab" data-bs-target="#Korean" type="button" role="tab" aria-controls="Korean" aria-selected="true">Korean</button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link" id="English-tab" data-bs-toggle="tab" data-bs-target="#English" type="button" role="tab" aria-controls="knitr" aria-selected="false">English</button>
  </li>

<div class="tab-content" id="language-tabcontent">

<div class="tab-pane fade  show active" id="Korean" role="tabpanel" aria-labelledby="Korean-tab">

::: {#Korean .tab-pane .fade .show .active role="tabpanel" aria-labelledby="Korean-tab"}

# WSL Installment

## WSL (Windows Subsystem for Linux)

Windows Subsystem for Linux은 Windows에서 리눅스 실행환경을 지원하는 Windows의 확장 기능

* Windows에서 바로 리눅스 명령어를 실행할 수 있어서, Windows와 리눅스를 함께 사용하는 개발자들에게 편리
* WSL 이전에는 가상 머신 (Virtual Machine, VM)을 많이 사용했었음
    * VM: 컴퓨터 안에 구축된 가상 컴퓨터 개념으로 CPU, Memory, Network Interface, and Storage를 갖춘 온전한 컴퓨터 시스템으로 작동하는 가상환경
    * 하지만 VM은 메모리 overhead가 심한 문제점이 있었음
        * overhead: 컴퓨터가 어떤 연산 및 처리를 하기 위해 들어가는 간접적인 처리시간 메모리등을 말함
        * 예를 들어, VM을 쓰려면 컴퓨터가 디스크와 메모리의 일정 이상 부분을 할당해줘야 VM을 쓸 수 있었음
        * 그래서 VM이 많을 수록 overhead가 심해지는 현상이 발생했는데 WSL 개발 이후로 Linux를 더 가볍게 사용할 수 있게됐음

## Why to install WSL?

* Airflow는 Windows에 직접 설치 불가
* Windows에서 리눅스 작업환경을 만들기 위해서 WSL 설치가 필수
* 여유가 된다면 가상화 VM 또는 Public Cloud (AWS, GCP, Azure)의 컴퓨팅 서비스에서 Linux 및 Airflow 설치 가능

## How to install WSL?

* 설치 전 체크사항 (시작버튼 → 시스템 정보에서 확인)
    * Windows 10 버전 2004 이상
    * Windows 11
* PowerShell 명령어로 설치
    * wsl --install
* ![WSL Install 설명 공식 홈페이지](https://learn.microsoft.com/en-us/windows/wsl/install)
    * Open PowerShell or Windows Command Prompt in administrator mode by right-clicking and selecting "Run as administrator"
    * `wsl --install` 실행
    * Enter New UNIX username/password
    * turn off PowerShell
    * turn on PowerShell again
    * `wsl -l -v` 실행 반드시 version 2가 설치되어 있어야함 (WSL2)
        * WSL1이 설치되었으면 WSL2 업그래이드 해야함 (windows update 해야함)
        * *WSL1은 나중에 사용할 docker가 제대로 작동하지 않음*

## Frequently Used Linux Commands

* `pwd` : (print working directory) 현재 디렉토리 경로 출력
* `ls` : (list) 현재 디렉토리의 파일 목록 출력
    * `ls -a` : -a 옵션은 숨겨진 파일 출력
    * `ls -l` : -l 자세한 정보 출력
    * `ls -al` :  숨김 파일 (.파일명) 까지 볼 수 있음
* `cd` : (change directory) 디렉토리 변경
    * `cd ..` : 상위 디렉토리로 이동
    * `cd ~` or `cd` : 홈 디렉토리로 이동
    * `cd /` : root(최상위) 디렉토리로 이동
* `mkdir` : (make directory) 디렉토리 생성
    * directory와 file의 구분은 `ls -al`에서 파일권한 column에서 맨앞이 file은 `-` directory는 `d`로 표시되어 있음
* `touch` : (touch) 새로운 파일 생성
* `rm` : (remove) 파일 삭제 (디렉토리 포함: 옵션 r, `rm -r`)
    * `rm -rf`: 강제 삭제
* `cp` : (copy) file 및 directory 복사
    * `cp file1-to-copy file2-name-to-be-copied` : `cp file1 file2`
    * `cp -r dir1-to-copy dir2-name-to-be-copied` : `cp dir1 dir2`
* `mv` : (move) 파일 이동 및 이름 변경
    * 파일 이동: `mv file1 dir1`. 이때 dir1은 existing directory
    * 파일명 변경: `mv file2 file3` file2를 file3로 renaming. 이때 file3은 non-existing file
* `tar` : (Tape ARchiver) 파일 및 디렉토리를 압축 (여러 directories 및 files을 하나의 file로 압축) 및 해제
    * 압축 : `tar cvf name.tar file-to-zip` $\rightarrow$ `tar cvf dir_1.tar dir_1`
    * 해제 : `tar xvf name.tar` $\rightarrow$ `tar xvf dir_1.tar`

# Docker Installment

## Docker

리눅스내 가상화 관련 커널을 활용하여 어플리케이션을 독립적 환경에서 실행시키는 기술
가상화 서버(VM) 대비 Guest OS가 없어 경량화된 가상화 서버로 볼 수 있음

![Docker Compoenent Architecture](../../../../../images/airflow/docker-installment.PNG)

# Airflow Installment

* Airflow 설치 방법은 여러가지가 존재하며 그 중 하나가 도커 설치임
    * [Docker 설치 링크](https://airflow.apache.org/docs/apache-airflow/stable/howto/docker-compose/index.html)
* 도커 컴포즈 (docker compose)를 이용하여 한번에 쉽게 설치 가능
    * docker compose: 여러 개의 도커 컨테이너 설정을 한방에 관리하기 위한 도커 확장 기술로 에어플로우를 설치하기 위한 도커 컨테이너 세팅 내용이 들어있음
 
# Development Environment Setting

## 개발 환경 권장 사양

* CPU: 4Core 이상
* Memory: 16GB (권장-문제없음) / 8GB (최소-약간 버벅 거림)
* WSL에서 컨테이너 다수 실행시 메모리 점유율 상승

## 개발 환경 workflow

![개발 환경 workflow](../../../../../images/airflow/development-workflow.PNG)

* 개발환경 세팅의 목표
    - 로컬 환경에서 만든 dag을 컨테이너까지 배포하는 것
* Actions
    1. 로컬 컴퓨터에 파이썬 인터프리터 설치
    2. IDE(VScode) 개발환경 설정
    3. Github 레파지토리 생성
    4. 로컬 컴퓨터에 Airflow 라이브러리 설치
    5. WSL에 Git 설치 및 git pull이 가능한 환경구성

## Python Interpreter Installment

* Actions
    1. 컨테이너에서 사용하는 파이썬 버전 확인
    2. 파이썬 인터프리터 다운로드 (https://www.python.org/downloads/)
    3. 로컬 컴퓨터에 파이썬 설치

## VScode Installment

* VScode란?
    - Microsoft사에서 2015년에 제작, 다양한 언어 개발을 돕는 IDE 툴
    - Visual Studio 라는 IDE 툴과는 엄연히 다른 툴
* Actions
    1. VScode 다운로드 (https://code.visualstudio.com/download)
    2. VScode 설치, 파이썬 확장팩 설치
    3. 프로젝트 생성, 파이썬 가상환경 설정
* 파이썬 가상환경
    - 라이브러리 버전 충돌 방지를 위해 설치/사용되는 파이썬 인터프리터 환경을 격리시키는 기술
    - 파이썬은 라이브러리 설치 시점에 따라서도 설치되는 버전이 상이한 경우가 많음

![가상 환경의 필요성](../../../../../images/airflow/virtual-environment.PNG)

## Git Environment Setting

* Github Repository 생성
    * Git vs Github
        - Git: 오픈소스 분산형 버전관리 시스템 또는 프로그램
        - Github: Git을 기반으로 소스를 공유할 수 있도록 만들어진 웹 서비스
    * Git 레파지토리: Github 에서 생성(https://github.com)
* Git Push & Pull

![Git Workflow](../../../../../images/airflow/git-docker.PNG)

## Airflow Library Installment

* Airflow 라이브러리 설치 대상과 설치 이유
    * 로컬 컴퓨터의 파이썬 가상환경(venv)
    * Why? Airflow DAG 개발을 위해 Airflow의 라이브러리들이 필요
* Airflow 라이브러리 설치 가이드
    * https://airflow.apache.org/docs/apache-airflow/stable/installation/installing-frompypi.html
* 리눅스에서 파이썬 Airflow 라이브러리 설치시 그 자체로 Airflow 서비스 사용 가능
    * WSL에서 pip install 명령으로 Airflow를 설치하지 않는 이유?
    * pip install 로 Airflow 설치시 저사양의 아키텍처로 설치되며 여러 제약이 존재함 (Task를 한번에 1개씩만 실행 가능 등)
:::
</div>

<div class="tab-pane fade" id="English" role="tabpanel" aria-labelledby="English-tab">

::: {#English .tab-pane .fade role="tabpanel" aria-labelledby="English-tab"}

:::


</div>


# Go to Blog Content List

[Blog Content List](../../content_list.qmd)