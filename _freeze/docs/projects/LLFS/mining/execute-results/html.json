{
  "hash": "c9fb97d55b23d82cc36266ab27cbc48b",
  "result": {
    "markdown": "---\ntitle: \"Data Mining\"\nsubtitle: \"Unsupervised Learning\"\ndescription: \"Data mining was performed to observe patterns of data in macroscopic observations or in the level of large data.\"\nauthor: Kwangmin Kim\ndate: 2023-02-25\nexecute:\n  warning: false\n  message: false\n  freeze: true\nformat: \n  html:\n    toc: true\n    number-sections: true\n    page-layout: full\n    code-fold: true\n    fig-width: 8\n    fig-height: 8\n---\n\n\n\n\n<ul class=\"nav nav-pills\" id=\"language-tab\" role=\"tablist\">\n  <li class=\"nav-item\" role=\"presentation\">\n    <button class=\"nav-link active\" id=\"Korean-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#Korean\" type=\"button\" role=\"tab\" aria-controls=\"Korean\" aria-selected=\"true\">Korean</button>\n  </li>\n  <li class=\"nav-item\" role=\"presentation\">\n    <button class=\"nav-link\" id=\"English-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#English\" type=\"button\" role=\"tab\" aria-controls=\"knitr\" aria-selected=\"false\">English</button>\n  </li>\n\n<div class=\"tab-content\" id=\"language-tabcontent\">\n\n<div class=\"tab-pane fade  show active\" id=\"Korean\" role=\"tabpanel\" aria-labelledby=\"Korean-tab\">\n\n::: {#Korean .tab-pane .fade .show .active role=\"tabpanel\" aria-labelledby=\"Korean-tab\"}\n\n\n\n::: {.cell}\n\n:::\n\n\n## Data Mining\n\n### PCA (Principal Component Analysis)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmetabolite_data <- all_data[, -c(1:5)]\noutcome_data <- all_data[, 2]\n\n# normalize the metaoblites\nnormalized_metabolite_data <-\n    as.data.frame(lapply(metabolite_data, function(x) scale_function(vector = x, method = \"min-max\")))\n\n# extract the latent variables (PCs: Principal Components)\npc_metabolites <-\n    prcomp(normalized_metabolite_data)\n\ntransformed_metabolites <-\n    as.data.frame(pc_metabolites$x) %>%\n    janitor::clean_names() %>%\n    mutate(row_names = 1:n())\n\ntemp <-\n    as.data.frame(pc_metabolites$rotation) %>%\n    janitor::clean_names()\nloadings_metabolites <- temp %>%\n    mutate(\n        metabolites = rownames(.),\n        arrow_size_normalization = min(\n            (max(transformed_metabolites[, \"pc1\"]) - min(transformed_metabolites[, \"pc1\"]) /\n                (max(temp[, \"pc1\"]) - min(temp[, \"pc1\"]))),\n            (max(transformed_metabolites[, \"pc2\"]) - min(transformed_metabolites[, \"pc2\"]) /\n                (max(temp[, \"pc2\"]) - min(temp[, \"pc2\"]))),\n            (max(transformed_metabolites[, \"pc3\"]) - min(transformed_metabolites[, \"pc3\"]) /\n                (max(temp[, \"pc3\"]) - min(temp[, \"pc3\"])))\n        ),\n        arrow_pc1 = arrow_size_normalization * pc1,\n        arrow_pc2 = arrow_size_normalization * pc2,\n        arrow_pc3 = arrow_size_normalization * pc3\n    )\n# arrow_size_normalization is a normalization factor that\n# ensures the variable loading arrows are scaled appropriately relative to the data points.\n# The min() function to find the smallest ratio between the range of the data points and\n# the range of the variable loadings along each principal component axis (pc1, pc2, and pc3).\n# The reason why I select the first 3 components is that\n# '3' is the maximum dimension that can visualize the PCA results in 3d.\n\noutcome_transformed_metabolites <-\n    transformed_metabolites %>%\n    mutate(\n        outcome = outcome_data,\n        row_names = 1:n()\n    )\n\n# total variance\ntotal_variance <-\n    data.frame(\n        pc = 1:500,\n        total_variance_explained = (pc_metabolites$sdev)^2 / sum((pc_metabolites$sdev)^2)\n    )\n\nggplot(\n    data = total_variance %>% filter(pc < 21),\n    aes(x = pc, y = total_variance_explained, group = 1)\n) +\n    geom_point() +\n    geom_line() +\n    labs(title = \"Scree Plot, Total Variance Explained by 20 PCs\") +\n    ylab(\"Total Variance Explained\") +\n    xlab(\"Principal Components\")\n```\n\n::: {.cell-output-display}\n![](mining_files/figure-html/unnamed-chunk-2-1.png){width=768}\n:::\n\n```{.r .cell-code}\n# 2D PCA Scatter Plots with PC1 and PC2\nggplot(\n    data = outcome_transformed_metabolites,\n    aes(x = pc1, y = pc2, color = outcome)\n) +\n    geom_text(alpha = .5, size = 3, aes(label = row_names)) +\n    stat_ellipse(type = \"norm\", level = .99) +\n    geom_hline(aes(yintercept = 0), alpha = 0.5, size = .1) +\n    geom_vline(aes(xintercept = 0), alpha = 0.5, size = .1) +\n    scale_color_manual(values = color_function(length(unique(outcome_transformed_metabolites$outcome)))) +\n    labs(title = \"2D Scatter Plot of the First 2 PCs Grouped by AD status\")\n```\n\n::: {.cell-output-display}\n![](mining_files/figure-html/unnamed-chunk-2-2.png){width=768}\n:::\n\n```{.r .cell-code}\n# biplot\n\nggplot(data = outcome_transformed_metabolites, aes(x = pc1, y = pc2, color = outcome)) +\n    geom_text(alpha = .75, size = 3, aes(label = row_names)) +\n    geom_hline(aes(yintercept = 0), alpha = 0.5, size = .1) +\n    geom_vline(aes(xintercept = 0), alpha = 0.5, size = .1) +\n    coord_equal() +\n    scale_color_manual(values = color_function(length(unique(outcome_transformed_metabolites$outcome)))) +\n    geom_text(\n        data = loadings_metabolites, aes(x = arrow_pc1, y = arrow_pc2, label = metabolites),\n        alpha = 0.5, size = 5, vjust = 1, color = \"red\"\n    ) +\n    geom_segment(\n        data = loadings_metabolites, aes(x = 0, y = 0, xend = arrow_pc1, yend = arrow_pc2),\n        arrow = arrow(length = unit(0.5, \"cm\")), alpha = 0.5, color = \"red\"\n    ) +\n    labs(title = \"Biplot, the Effect of Metabolites on Samples with Disease Status\") +\n    ylab(\"PC2\") +\n    xlab(\"PC1\")\n```\n\n::: {.cell-output-display}\n![](mining_files/figure-html/unnamed-chunk-2-3.png){width=768}\n:::\n\n```{.r .cell-code}\nfig <- plot_ly(\n    x = ~ outcome_transformed_metabolites$pc1,\n    y = ~ outcome_transformed_metabolites$pc2,\n    z = ~ outcome_transformed_metabolites$pc3, type = \"scatter3d\", mode = \"markers\", color = ~ outcome_transformed_metabolites$outcome,\n    colors = color_function(2),\n    size = 2\n) %>%\n    layout(\n        title = \"Effect of Metabolites on Samples with Disease Status in 3d\",\n        scene = list(bgcolor = \"#e5ecf6\"),\n        xaxis = list(title = \"PC1\"),\n        yaxis = list(title = \"PC2\"),\n        zaxis = list(title = \"PC3\")\n    )\nfig\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-c206725ce456b96c9d8d\" style=\"width:100%;height:650px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-c206725ce456b96c9d8d\">{\"x\":{\"visdat\":{\"8785fe61d3e\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"8785fe61d3e\",\"attrs\":{\"8785fe61d3e\":{\"x\":{},\"y\":{},\"z\":{},\"mode\":\"markers\",\"color\":{},\"size\":2,\"colors\":[\"darkblue\",\"darkred\"],\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter3d\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Effect of Metabolites on Samples with Disease Status in 3d\",\"scene\":{\"bgcolor\":\"#e5ecf6\",\"xaxis\":{\"title\":\"outcome_transformed_metabolites$pc1\"},\"yaxis\":{\"title\":\"outcome_transformed_metabolites$pc2\"},\"zaxis\":{\"title\":\"outcome_transformed_metabolites$pc3\"}},\"xaxis\":{\"title\":\"PC1\"},\"yaxis\":{\"title\":\"PC2\"},\"zaxis\":{\"title\":\"PC3\"},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"x\":[0.765421463726851,-0.152826637776619,-1.04184037473144,0.275767309887406,1.38998124442696,-0.196395083381491,-2.10563166829853,-0.461229475653178,0.199717655107799,-1.77750702990623,-4.0376002032788,0.529685093654856,-2.26511222602725,0.521895466438179,0.591005291901851,-0.201051913126238,-0.994338572669424,-1.01542561125333,-3.31834818183744,-0.622960985887568,0.203698171643261,-0.522858297166657,0.368590171581924,-0.286577664268803,-0.99183198806277,-0.138162592119322,-0.834961257870401,-0.803765484596002,0.432767368962841,-3.67566232132598,-0.514723925774377,0.58446885447145,-0.843807542840101,-0.69538566039085,-1.13390887854956,-1.33069512665715,0.344735310370745,0.213584244823337,0.190655855854367,-1.06747324999105,0.714538389970699,-1.85765306050415,-0.708501395921543,-0.739608980937722,0.979372080317579,-0.365548058457673,1.34398066182985,-0.646017346021022,-0.953009628179269,0.130500907936232,-0.205309541714647,-0.0176300876035093,-0.547433184021827,-2.48941561903686,-0.663038992146206,-1.13695754933552,-0.483204702281205,-1.73737981329023,0.324417897331544,-1.59466438906964,-3.05042839238026,-2.10196437474631,0.226421858338069,1.56254786486901,-2.04039622964922,0.558877566661982,1.35118554184518,-0.388101273648377,0.485454475880276,-0.954011217181022,-1.59392407271521,-1.52398746584591,-1.19513576447339,-0.723219594379703,1.0670868433599,-0.662163165440056,-0.729037222249476,-1.18082315177044,2.81699116604217,0.0240647838113923,1.42021225987544,-0.703573868559682,-3.48786021505529,-0.845996717144189,-0.542627562938763,-0.216387712618601,-1.45305269296765,-1.02549675721549,-1.30506755268333,-1.19843069330474,0.98929089694443,-0.930217412371338,-0.995836096936475,-1.4082127574328,0.522965085656861,0.0220353696734174,-0.436251447683686,-0.562433363867235,0.50722622821883,0.509679412746256,-0.392437992395342,-1.57378746290128,-1.7090767267973,-2.03536687742527,0.936965742599895,2.32768798892809,1.97249058262551,-0.489016806119174,1.86788784322629,-1.36829142416902,-1.07884511941685,-0.743481603635997,-0.02385217034434,-2.59197242919686,-1.8263924006762,-2.04625599206936,-0.539720051010829,-2.39226661397288,-0.483818282841792,0.452297475784648,-0.0501844368434504,-0.837489021582278,-0.190085705737277,-0.53109463670853,-2.50866409719733,0.989749854517621,-0.895776047570131,-0.251218456857536,-3.81499381716275,0.598892440809241,-0.403351816612438,-2.95047585407009,-4.17226602546262,-0.112878560674485,0.184177470228427,-0.882445525454199,1.57674686673836,0.368012528039505,-0.220930214038753,-1.90410872716593,-0.294777639104843,-1.278227298231,1.17224221528557,-0.185630553464154,-1.20717969927318,0.189260745849519,-0.71106737748043,-1.12292511831224,-0.185355838042696,1.05362908370288,-2.75232476920297,0.214430052868042,1.084473035254,-0.99635550908341,-1.02427682009183,0.0976643275109016,-0.741714752988661,0.421882495640714,-0.697916407906869,0.76805631060761,-0.883414167372764,-2.33057492727509,-1.85404373381325,0.629891763261171,-1.63960222628995,-2.05297556959145,-0.277897953812169,-1.30657321048746,0.0400682551366215,-0.0776940015662394,0.461926215367015,0.0591660029149296,-0.264366723301403,-0.609183866593225,0.732803343652743,-0.160700651865687,-1.35095056404267,-1.81836777278819,-1.3664116433272,-0.232382379899746,-2.03670376163484,-0.678702718618021,0.0833202538024875,-2.9756066547388,-5.06987337552789,-1.29702497040251,-0.516440610064522,-1.36296268704989,-1.22069033678821,-0.880525680115924,-2.29787578511895,0.859624807818654,-0.640417406749219,1.18885199287119,-2.08767109056161,-0.512693658390241,-1.24643074005635,-0.492009939821341,-1.72102068879163,-0.517501839269985,-1.20480913636422,-0.549635549184965,-3.33080774400592,1.95555940415244,-2.28265654965575,-0.489269294428025,0.622737272300689,0.751716829863976,-1.40601339173858,-0.686533586957244,0.332561797743684,-1.42417212002607,0.249361938388607,0.89760614970892,0.379986611604455,-1.73591578818349,0.532517651484554,0.57308667793639,-0.467605040259344,0.406496219253338,-0.0584518812470594,-1.25016871058533,-1.70558680387831,1.08331661126279,0.179582825216279,-3.61254054017512,0.937062410665356,-0.345603341017121,0.435582718088613,-0.582954066643626,-0.812379535904834,-2.72085847873576,-0.78928638155142,0.0234471976940418,-1.24955974334976,0.277001996538984,1.53401005834431,1.53723735867898,0.564087689042848,-2.75126816032136,1.13750371818515,-0.72462360527233,-1.4140983342248,-1.09151108136506,-0.991365924500305,-0.491884038098744,1.20386981259078,-1.47357515669128,1.45888872349391,-1.35339123266407,-0.660868612032807,-1.29001901533062,-0.669921823316233,0.0487452009846828,-2.48979566230601,1.10542615293268,-1.71583818146843,-1.17008286229002,-1.61685889027048,-2.19647934346628,0.152691714466792,1.47358338976249,-0.234756574760271,-1.38061798119703,1.10207485332092,-2.14308199172222,-1.3510376717604,-0.022457462762104,-0.432750952786404,-0.709619659060245,-2.44338152385872,1.33555499964393,-1.11566618554963,-0.275697094808132,-0.407029490181608,-0.965720618896427,0.0975569456239303,-0.515741890330387,1.13406096423545,0.681487339232654,-0.718164300618262,2.08676588713753,0.459285196012325,-1.76031992509393,-1.29657939722276,0.917360137592864,-0.651090825412926,-2.00161561727353,1.85298395033283,-0.0887602713172633,-0.755759208734852,-0.0966020364313508,0.421038387362673,-1.93217791570844,-0.74158348943294,-0.569550682043801,-0.58072334827868,-0.873138419631553,-0.609901320808497,0.382152317278543,-1.7488401967605,-0.910307581250974,-0.0220000671910774,-1.20869561136165,2.49849401593001,-3.42441962197728,0.913779455627286,0.208212452576121,-0.523263696762655,-2.54579969492135],\"y\":[-1.10390586597695,-0.314590500148265,-2.52869018620016,0.734292596125979,1.61173972682122,-0.450765584950063,-1.60250646899923,0.153124600922785,-2.28706984945942,0.558499900494754,0.571022708899039,0.312059382455361,0.699361714790627,-2.12700413634822,-1.51661910471281,-2.31610813030311,1.48360622178153,-0.546569316966623,-3.56548275118259,-1.56853741268387,2.48847193835424,1.64552383892964,0.0693191423239225,-2.04169538019837,-0.237591443935009,1.83564216712891,1.1308188840259,-1.36112470116574,1.06905419581297,-0.690613454982141,0.306190274483941,-0.112436213635878,1.36073645022643,-0.430277631422778,-2.38013100568796,-0.0905727180415963,0.584189134166676,-1.01239295307525,-0.587378746670735,0.737652134834784,0.614203898031495,1.82917746970914,-1.8618476122687,0.139479145992662,-1.19354291232212,0.602914228318486,1.43325361145916,0.620640511622759,-0.180965359986504,-2.63638961129797,-3.25738847479068,1.11959065806269,2.26007802190467,0.856900259350948,0.594820415248302,1.23684054286745,1.46916649115349,0.282940128118535,0.751534323229776,0.925144488136413,-0.813847971966203,0.95320262384959,0.529866417674867,-1.76079306857014,1.79156937127933,-1.25717581645744,1.91599176216072,0.252642268053626,1.38029718286631,0.917796504112543,-1.41144856236383,0.203356999330381,-0.0768984272490928,1.78440110555845,0.532395320385093,0.0713523871354031,0.721660565893558,-0.512526746769587,-0.466190944091276,-0.570821069414183,-0.791377035781065,1.31971108130358,1.29300121612051,-0.736121576092545,-0.654256097048505,1.28468470455433,-2.07131033278371,-1.53384394425184,-0.29253999224787,0.150656806121142,0.2231048358243,0.0696926518696556,-0.564538157144023,-0.284432564747608,-0.00258117238578755,1.55625845031859,0.559633124178131,-0.876755712917019,-0.444445134401637,1.1548544779616,0.0297325173596526,-2.47410812699489,2.20867451072059,-2.45891468496466,2.07009844995294,-1.18699297777967,-0.278100548575875,-0.0154003406150653,-2.55793115833544,1.65569513589605,-0.183789467833525,1.8981508583693,-0.0749105947781314,1.33490843332284,-0.782883481091495,-0.192380203242286,0.40822034962851,-2.41197990616552,1.45062773141911,-2.28975649084291,0.62834017549592,0.77450014760481,0.0199774837443576,-0.692745374888889,2.09849465827904,-0.827900904053543,-0.86867129290023,-0.198009351083707,0.323651411431553,-0.999024403211771,-0.234339711063463,1.57726930604052,1.79609150846395,-2.09730088205684,-1.13087626581649,0.451306863661283,0.227835374184491,-0.4355785156791,2.5324752974663,0.250834247034615,-1.46932630486699,-0.600751323815291,0.708798112379468,-0.723410967818895,2.85316725968628,0.4290251433133,0.77571464224372,3.26676602933643,0.350210417420568,0.368216071147638,0.0415181257679218,0.389166642924579,-0.942193369656556,-0.281066021867941,-0.316616958434861,-0.930668025453702,1.61921453636786,3.82227639372998,-1.32615402052298,-1.88522042996122,0.31940153921156,2.27907687795036,0.0388728572533545,0.760527829652386,0.0598328149921045,0.132249418476977,2.451233859956,0.0801299296831469,-0.731133908448116,-0.316814736192036,-0.703819384258323,1.42914710302913,0.560123127233519,1.19178345982159,-1.54658019885446,0.811024660477447,-0.375394137761614,-0.206216535163164,-0.725710597444927,-1.87896150069246,0.630737206334992,0.70863955731556,-0.913075558924009,0.711613718605615,-0.441968736445841,0.377725790371364,1.7998128445317,0.232555177788321,-0.925055507228021,-0.317876826189768,-0.704806584502431,1.69163961365291,-1.31166907434651,-0.122450194106832,-0.68715389961131,0.474442078005056,-0.65977058668813,0.0646189477302779,0.0957915916707203,1.0626471082622,-0.114181581612761,1.10581188398812,-1.48456530488295,0.290295403182629,-0.822664095597357,0.266243582015058,-0.168255606472235,1.15754413777186,0.866388620594473,-0.343857378652447,0.0629825621467877,0.168944380843125,-0.343656824049371,-0.270399808054777,0.720466073759169,-0.457962659691198,-2.00163224780559,0.411423205539539,0.544374088021428,0.135402200598599,-2.25956806529405,1.01498086514075,1.91737955800963,0.320586206518517,2.10860988994504,1.7525940245863,-2.24195038121119,0.620544698940401,-0.154825615316942,0.141182973191835,-2.57059482099751,-0.572896599546685,1.62808440121937,2.51022435992518,-1.33163546083439,0.634151180958743,-0.805432496223448,-0.115637283458551,-2.328230817313,-1.7299106140909,-0.583264355171165,-0.841076100714419,-1.13190560983537,-2.96144898254512,-1.41976095159324,-0.442763179588031,-0.199553726858465,1.01336633324709,-0.385342797667102,-1.04889571924396,1.00269283892782,0.131006669011931,-2.31895429414467,-2.52722655505456,-2.55799851274582,2.58093041522721,0.113145016341475,-1.11630120010106,-0.486976285344905,0.607580308260478,-2.19287560959101,1.23567976014907,0.659407543921071,0.680982749464112,0.32509211081602,-0.624139286545793,-0.100496222447451,-1.14007305582696,0.00688537183533614,-0.507258456410087,-0.524468948267986,0.792178243884312,0.446245457454677,1.32793418203674,-0.774015046171086,-1.7117726616687,1.76027408260552,-3.44558143335015,-1.34754279670581,1.78695354787828,-0.449166542857229,0.310241875001869,-0.0416904450133118,-0.968000108097988,-0.460356865859477,-0.993099730458994,0.291547455308006,-0.358686602816461,-0.331352926004747,-1.14630439783273,-0.298555577312082,-1.48357541088489,2.29451304919553,1.01716172466099,1.4477598169328,-1.2948366964199,-1.21563607190929,0.451089681048551,0.770251561102772,-0.763583113323661,0.55289010856357,-1.57845484307149,-0.057880480526058,-0.249184634067872,0.766205608069441,0.908728790042775,-1.01256961581781,0.253999092057574,0.0976057823501,0.794814057477914],\"z\":[0.70334110001012,-0.799576612640141,-0.826175815572748,-0.521263568356233,0.735467855784012,1.58488873115437,0.529133680966071,0.489605705431225,0.272749998010939,-0.155772968652696,-1.00731238430026,0.587085724521182,0.645123334488595,-0.258197067337051,-1.48226310788966,-0.311225883175718,-1.47493165634736,1.04182521495826,0.616197020020937,-0.284680256973335,-1.16486721619532,-0.143910937755695,0.730220577579452,0.777071292347938,1.32491551572559,3.15909139248969,-1.41143529564382,0.604901881141504,0.340376767626644,0.749410311591094,-0.572179606423766,0.864077882913101,-0.907735190999474,0.365690936194093,-0.284771019915509,-1.08423925219194,0.239268061261818,-0.183166683064286,-0.824994439640325,-1.35596668573477,0.608531474056796,2.5292222621314,0.95706985931057,-0.32489154686279,-1.49892423631202,2.41731785147906,0.48671253060474,-0.184475920595544,0.223839593770597,0.660902288090157,0.737005702206059,0.279637229253801,1.94507146822056,-0.322457044938898,-1.02214378309261,-0.455085735866642,-1.00840649562023,-0.131863540169422,0.391446071910807,-1.58590356116276,-0.404625997194391,0.428576219485539,-0.414716874790891,-0.233510862362463,-0.216146308472413,-1.89922581869014,0.764220742887066,0.161625302203173,-0.691897398955263,-1.10727198872867,-1.62496362958756,0.41426910718426,-0.979154209144667,-0.206566139172177,1.52837202355902,-1.96143779354339,0.118630499668886,-1.54764185646418,-0.0422684818817903,1.28011045128005,-0.427367799672612,-0.538427189390035,0.638848798458387,-0.558462468899156,-1.45430555627615,-0.845351070545016,0.00408949254411757,0.936288964638024,-1.08618981972207,-1.99868524822492,-0.789446319369129,-1.719595768343,-0.9944368835953,0.211099119955898,-0.0072994867156319,1.1446143356982,2.43674090845998,-1.88950900621846,0.139967021711765,-0.558271666511529,-1.27545056606793,-0.89724238110728,1.7149792898114,0.830453161831948,-1.20909326900864,1.86749159502924,-0.618834681772931,-0.806140804913301,0.2756859031391,-0.764266325885588,-0.275531537116259,1.09138763904881,0.41701674633777,-1.53670472587259,1.03184205250913,-0.50978302902428,-0.518692875238343,1.24266310229624,0.158116410256837,0.484347534292221,-1.41507254256996,0.0982253212438173,0.871967423360771,-1.31263972230403,1.05202466324538,1.99608670991362,0.305973235448581,0.323353767811539,0.189970037915909,0.388972806944415,1.09380662886551,-0.276865459325732,0.896962446869757,1.15572951517847,1.03709179999574,-1.42820343727234,-1.9505820526934,1.3708755082571,-0.216779945737512,0.934473658338374,-1.11015281409019,0.721239623105868,0.268895234212152,0.4740452856717,-0.0693575226953617,1.4619353308016,0.644591333334124,-1.18351727937224,1.56035871544392,1.37174014253786,0.857111503891151,-0.467636417610821,-0.380405229426815,0.0629991045068372,1.07158398680784,-0.817584557136447,0.973683444427382,1.44539280804002,0.539120927887537,-1.05008232367048,0.670601953436425,1.41910038889328,-0.41626607140341,0.0373347087868735,-0.534508672789435,-0.86416863746208,0.239823451409711,-0.0902303104713493,-0.605132566825584,-0.444005291235728,-1.59724140586487,2.53147030817425,-1.17070759757345,1.8424460236711,1.74467546795408,2.79579846864051,-0.860188004411852,-1.77553657349416,0.032673358462844,2.21963510840669,-0.657894926072493,-0.604941878166178,0.306293478829676,0.423101409975202,-0.0663023724244995,-0.0033849901582269,-1.84931803150162,-0.0718476853815438,0.878535549763376,-0.810174526023661,1.6332056689499,-0.397988779385703,1.91912437518279,-0.452840082754908,0.0682369045613453,-0.639131581579166,1.18784728058447,-0.631414216945169,1.82927255333654,-0.831705923070656,-1.15542707367031,1.25538473969049,-0.793236112055776,0.00248754640197716,1.29750701455054,1.26143594811669,1.47508561032183,-0.865921031886058,-0.294509578655736,-0.298223166122378,0.504837410914135,0.414922268466871,-0.164382327678889,-1.26749588360738,0.0593123168152689,-0.474347402842299,-0.0907667359140377,-0.96948828851757,0.395213950225285,-0.700696024959602,-0.672553029366862,-0.168508035621518,-1.26558141615811,-0.202841508588342,0.314630010886653,-0.873025322237763,1.94152987160587,-1.45428604688515,0.176811942436397,-1.88771934435386,-1.39705074712046,-0.9764009096705,1.32860284587572,-1.17710098429838,0.259860745111238,-1.7758780114016,-0.732008253020785,0.923112031066511,-0.515289930514881,-1.27575280594395,1.0866524328937,-0.230499657727498,0.0314953270303236,0.251344161773284,2.31368754944468,0.880421615289942,-0.507229569595717,-0.717811369517522,-0.127790109440448,-0.184034401979092,-1.7990447838478,1.40366769186236,0.519019058143912,-0.721170707257269,-0.660639341938982,0.211433581262661,-1.0554263508642,-0.514569504500714,-1.25360283433846,1.04571979338888,-0.615131413471313,-0.19133685976901,1.20402008827126,0.89658020935111,-0.186120524766492,1.70726540082182,1.18123450552621,-0.101925561769803,1.57609102040792,0.175133476552084,-0.796293433941391,0.412243522343046,-0.905147803685627,1.80482643768255,-0.739711403419902,-0.840892122355328,1.16913075989753,3.13176890370211,0.24602207967543,-0.828011767453164,0.0231385865644555,-0.691421537967987,0.575082812219168,0.406951422137186,1.35645615645712,-0.216551926412238,0.736951246745079,1.5519600901317,0.696083923979558,-0.793935766960094,-1.99213500507455,-0.982432804011455,-1.69198679469936,1.40951672483101,-0.897852052719924,0.405492158674913,1.85396935117911,-2.06781183348561,-0.23120667702696,0.942387276594601,0.946056187257886,0.826109661982065,-2.39101495103086,2.46332513594952,-1.44676744132226,-1.48667598998779,0.837746069293658,0.538961787526218,0.0391083037996749,-1.06704090802178],\"mode\":\"markers\",\"type\":\"scatter3d\",\"name\":\"negative\",\"marker\":{\"color\":\"rgba(0,0,139,1)\",\"size\":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],\"sizemode\":\"area\",\"line\":{\"color\":\"rgba(0,0,139,1)\"}},\"textfont\":{\"color\":\"rgba(0,0,139,1)\",\"size\":55},\"error_y\":{\"color\":\"rgba(0,0,139,1)\",\"width\":55},\"error_x\":{\"color\":\"rgba(0,0,139,1)\",\"width\":55},\"line\":{\"color\":\"rgba(0,0,139,1)\",\"width\":55},\"frame\":null},{\"x\":[1.47711664110598,1.39094515007003,1.05613574235454,1.56665384173177,0.496575169864571,1.00589674311328,1.26537073619179,-2.68483205702085,0.420530827907748,1.2833716377326,1.59829490353284,1.2156190088326,2.12055835646675,2.02543258510514,1.38842435621786,1.86280299306916,1.95032072437734,-1.40573154363287,2.56115560558049,0.67743090185615,1.14443379520195,3.15484796665025,3.44602548532823,1.10479735009856,-1.92100735622993,0.550362147236384,1.17603234543534,2.79097688551513,0.443989432701937,1.89930767216189,2.31807429588579,2.29245388750998,1.26843666692615,-0.430709459523196,-0.276325482662241,1.49351100103914,1.66880492743259,-1.60876348162977,-0.920311846909147,-0.227491730915286,1.76527999171112,0.889157166897082,-0.101464951145779,0.91892089592594,1.53675842408816,1.81406264599916,1.95146077087532,0.0765492104735607,2.85774593087247,-0.430609925104678,2.14343934237086,1.30518853145079,1.20856616654739,2.5296384920595,0.510535209239846,1.16820699038408,2.11279996823732,0.656434242087592,-0.0100928299072616,0.0378780558561109,1.7202047227976,2.86730665867664,-0.843812869203583,2.40191818874287,-0.520047053104328,2.44383863805527,0.84692116599702,4.86247806533702,0.650700289766203,0.281463820518398,-0.135584794506655,-1.04926222077938,-0.433707143779014,-0.895045528861105,1.89111748936721,-0.297975706656741,1.98527746602728,0.679833886436596,-0.742678522850492,1.95678324317277,0.213096008575144,1.25070416912939,1.03157781699408,1.21723098051518,1.31560100417965,0.209533504209074,1.41012817114622,1.51783158263661,1.65679629294546,1.34136531593394,-0.254980841665872,1.58862927705968,0.616958597476311,1.19538047373307,2.0647202609413,-0.64036838289256,1.25910251393942,1.7482781896582,0.88202957194179,1.73366569401888,0.637366758397365,0.609985775191251,0.748285151700522,2.20411134622055,1.33593117727858,-1.55848621883812,-0.664564443717635,0.424950304630744,-0.715072579678349,0.259525770829777,0.425732071986264,0.675421109186049,1.58633727093851,0.739586021201349,2.17320777732752,-0.197156432078101,-0.0279634710214096,3.25592787974168,0.262173203968869,1.21804670510199,1.00600560291743,0.140170881239746,0.782524711810274,1.50002506258819,-0.659594159360648,0.506092007357245,1.80749039857628,1.97643760081983,0.883063123012147,0.186179571873716,-1.61160277775504,2.25883893332409,1.60326281097023,0.819158181396337,1.30717951302837,-1.3848326521772,0.392912693264403,1.89940768414532,-0.0807584142248361,1.28333765718412,0.897035248634536,1.60106858545354,0.877993222709312,-0.790983080567451,1.59934805557146,2.73291966589939,0.638767255447049,0.0934507812233356,0.265037479448099,1.99927254326379,1.10784295115339,1.31878586796286,0.998499189262853,1.6542339978772,3.22249087645079,-0.402777526221686,3.26298656354892,0.459732075181021,-0.846503204759706,-1.15754932827769,0.951487557763952,-0.418017849211229,0.0895528747813838,2.54721574757639,0.365208977276709,1.53216671014126,1.60334201260336,0.185432265206229,-0.838231980815788,-0.355768044645414,3.44145543370182,3.29070605332551,0.765435487761411,-0.102896671474802,2.52697393338846,1.53820518656357,1.09936702037092,0.520665821239215,0.467774594268102,1.36472574357167,-0.779978294140749,0.838403086345263,1.37914648607136,1.22565894032464,0.451075419364278,0.758361566163118,1.0622323463102,-0.731018224022144,-0.598985856723922,1.51845118320143],\"y\":[-1.90810355961798,1.99241305207203,-0.625287596569621,1.26387247282218,-0.0598378298792998,0.510677844392521,-0.654640580992204,-0.170609787601791,-0.163730500440022,0.756750545377176,-0.571095259164416,-0.297363312046155,1.9034827144383,1.52297341909161,0.367605284943346,-0.170680053198462,-1.53100997740608,-2.1339496733069,0.778997932730379,-0.063273875732012,-1.62685427144499,0.181889223614475,0.488861341728806,0.360773671114544,-1.477261153173,-0.610294593550818,-0.472082091499598,1.30829939770523,0.386952276025733,-1.12308782587742,-2.5192264724647,0.21583306578811,0.301489202172551,-1.55915840266407,0.606482599345878,1.11839986407416,-0.687444914019285,0.643716509368048,0.473436311550167,-0.484599426422966,-1.08425492567787,-0.710161586620983,2.23011223488452,1.77486656727728,-0.0136204094323353,1.77497721493159,1.10761494613913,1.35582700013606,-1.507527467011,-3.24523615961572,-1.47498721605771,-0.402514205844061,1.23393274430333,1.82021833963672,-0.985272925311865,3.46941681000458,-1.49015563430642,1.24156747618014,1.03367183091409,-0.596381964098504,-0.750413491817701,1.69936364194308,-1.7464574843965,-0.0486928586912313,0.909276052540324,1.17394900343577,0.922560116122852,-2.22795837313009,0.312664120116217,0.178804658936869,-1.05824734747167,1.08050509288483,1.87593906581491,0.157209108229087,-1.14713096307065,0.76303448601504,-0.775691510168071,1.38815649727707,2.90014332794154,0.97498636296997,-0.0156840664832134,-1.28490489850143,-2.55009147035376,-0.107733793759164,0.631596859206162,-0.300334356572379,0.331629006681791,0.460779386200814,-0.0783759811572686,0.583985968344612,-0.404757167657857,1.36190260296893,-1.23116094077623,0.697069372994163,-1.71476904652439,-0.84464223890918,-1.33435766788025,-0.356272222405109,-0.12729237540689,1.60526669584795,-0.00870530571063946,1.63291989452536,0.612549192534382,-0.689640565476606,0.720920122837864,0.617063925504982,0.495339879735799,-2.25620671618084,-1.51518113204546,0.255894758934814,-3.76623044358052,0.966067689693709,1.33933377884884,-1.59143101607379,0.555962116183823,0.807382918471418,0.131813870566114,1.05986629185968,-0.501463655977497,-0.441767529736479,-0.977091370173149,1.12971983299465,-0.0918029998513457,0.498927156635825,0.614334088266428,-1.09546934050106,1.94144107265434,0.431631251810921,3.40100118176068,2.82819469522742,0.822214389719256,0.880065174318302,0.502784103684577,-1.66402316158477,1.37193082714869,0.304191284498453,-0.533879305655745,-0.31368001106243,-0.601205680450873,-2.83802126846613,-2.18493311819755,1.16668749272152,-1.07482783319901,1.50215895917524,0.488323643736609,2.41597885118314,-1.33517011082818,1.90579041061037,-0.491468845516323,-0.231953446404041,-1.11240799061995,-1.46996174770981,-1.13269009289017,1.88172848774923,-0.228750419812389,-0.171408274128311,-0.151146930614141,-0.992292831921336,-1.89309656842958,-1.36812835428522,-1.30196411978174,0.0801287509738399,-0.226274954993786,0.631992162302837,1.83756518530089,0.00545108839538506,-0.862811148746398,1.41415159487614,2.36268825642046,0.116981222158448,-1.66328816343142,-0.98717822810638,0.412568194839107,0.526310609152941,1.14515307500259,1.59890909279195,-0.659677959740905,1.14902184339383,0.398541685075912,-1.54642175117298,1.41945249296856,-0.459478104099511,-0.99115065628476,0.818491837296186,2.55280818531902,0.0757428417907143,-0.574333150983065,1.03802994722973,-0.221255716301227,-0.471632903416366],\"z\":[0.499404474421802,1.69079195766203,-0.899512252986763,0.826326000853515,-0.813371892410796,0.0900805485285122,1.04777348451037,0.698934659539214,-1.12793527346397,1.39777471801005,-0.102588250131766,-2.30165445473773,0.518828224279837,-1.03529144750254,0.260763411375812,0.55885840786962,-0.427205480434406,-1.2921224322275,-0.566873949967789,0.441765942969052,0.0262370232222704,0.875382245979359,-1.06305002765455,0.648640856605986,0.192325030843617,-0.204501221731624,-0.933763769008013,-0.0858759887268699,0.031095232712858,1.06247419425829,-0.937106014482996,-0.798874946065098,1.21831911961283,-0.451960801730662,1.22646100375408,-0.190510888990069,2.8474582454003,0.856917112803698,-1.43591850449668,-0.196959252100013,1.19269247638968,-3.47665362606932,-0.280540501171251,0.856480893603867,2.16850084184491,2.99069389158145,0.936047305510863,-0.505242481411265,-0.068787371573276,1.19806725476532,-0.794709652713588,-1.68369379325081,-1.49343054019729,0.391393599188771,2.16179125283459,0.126394228167462,-0.477219150709073,-0.192250319882462,0.982029500755971,-2.52230961717689,-0.315113909671958,1.50043747673914,0.18118265248036,-0.692588394122253,-1.19065052690281,-0.148984340451979,0.54293637498904,-0.55248049234113,0.678562496544773,-0.613372480642294,0.25370204758668,-0.883887720091851,-0.880002667110148,-1.42319593300472,-1.49675468069612,0.759110596773042,-3.26966903870455,-0.991661296781647,-1.12239263688304,-0.824907460123315,-1.29384907544206,-0.293696376943835,0.458025868741834,-0.159517346992969,-0.0578298034785757,-0.664892999029447,-0.928570611595682,1.97545481778693,-0.459020185537175,1.6998603356825,0.0948384204646167,-0.529553424417255,0.0881798648983831,1.93674196951862,-0.24615071313172,-1.45782347810127,1.13812487352507,-1.08051592989163,-0.41104420955432,0.00981254640564239,0.921021603543685,0.278997709470478,-1.59650795314521,-0.60969791704679,-0.589267833594246,0.643093924694284,0.864475286057982,0.951946617039166,-0.00925360250613962,0.740072236059455,-0.671944138847458,-1.10924451686551,-2.86437650459467,1.55369977969587,-1.16230509566222,0.602827700579554,2.09556651968659,1.38117437557185,1.3675551984663,0.322734315504783,0.560270439210101,1.82680770960435,0.0308963900011388,2.03813469572537,-0.233339118409619,0.17759840253529,0.180833540158562,1.20110740052334,-0.812508654651342,-1.41841518893657,-1.42024853592829,-0.0845670875805775,1.69449206995971,-0.718427617655101,1.01483593543056,0.282429074510556,0.106513401054995,-0.517697593487155,0.0923450773136584,1.45936131025264,-0.778525391636304,-0.442055534476438,-0.934237618146685,1.14820727298227,0.187721473331168,1.85971981610043,0.561406480505846,0.799446496177059,-2.22671705379248,-1.01209879173275,-1.06833323145099,0.843767536746506,-1.57926922083755,-1.61204101401758,0.384066827524013,-0.549322034837384,1.55980874213293,-1.78448205551189,-1.58617017815924,-1.19578940215068,1.33500089697047,1.1305541729441,-1.49630098249693,-2.82919155148861,-1.12542271291639,-1.53483428623692,-0.215380487554079,-1.18999000106305,1.32403814625567,0.839959964628537,0.154452952969051,0.348083288612446,-0.83079015188016,-0.101982514644847,0.00739988826223393,-0.425135509743416,1.07457205545255,0.823440844022899,-0.793827938828458,-0.83931362043119,1.16130124734178,1.25439772231633,-0.991862453735201,-1.93277038807747,0.691402075949132,0.498555329782013,0.889774795470115,0.651282236750849,0.0126174729712485,-0.726712772916537],\"mode\":\"markers\",\"type\":\"scatter3d\",\"name\":\"positive\",\"marker\":{\"color\":\"rgba(139,0,0,1)\",\"size\":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],\"sizemode\":\"area\",\"line\":{\"color\":\"rgba(139,0,0,1)\"}},\"textfont\":{\"color\":\"rgba(139,0,0,1)\",\"size\":55},\"error_y\":{\"color\":\"rgba(139,0,0,1)\",\"width\":55},\"error_x\":{\"color\":\"rgba(139,0,0,1)\",\"width\":55},\"line\":{\"color\":\"rgba(139,0,0,1)\",\"width\":55},\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n\n```{.r .cell-code}\n# for (i in nrow(loadings_metabolites)){\n#  fig <- fig %>%\n#    add_segments(\n#      x = 0, xend = loadings_metabolites[i,'pc1'],\n#      y = 0, yend = loadings_metabolites[i,'pc2'],\n#      z = 0, yend = loadings_metabolites[i,'pc2'],\n#      line = list(color = 'black'),inherit = FALSE, showlegend = FALSE)\n# }\n\n\n#\n#    add_annotations(x=loadings[i, 1], y=loadings[i, 2], ax = 0, ay = 0,text = features[i], xanchor = 'center', yanchor= 'bottom')\n#    add_segments(\n#      x = 0, xend = loadings_metabolites$pc1,\n#      y = 0, yend = loadings_metabolites$pc2,\n#      z = 0, yend = loadings_metabolites$pc3,\n#      line = list(color = 'red'),inherit = FALSE, showlegend = FALSE)\n#\n#    add_annotations(\n#      x=loadings_metabolites$pc1,\n#      y=loadings_metabolites$pc2,\n#      z=loadings_metabolites$pc3, ax = 0, ay = 0, text = loadings_metabolites$metabolites,\n#      xanchor = 'center', yanchor= 'bottom')\n#\n# plot_ly(x=loadings_metabolites$pc1, y=loadings_metabolites$pc2, z=loadings_metabolites$pc3, type=\"scatter3d\", mode=\"markers\", color='red')\n#\n# loadings_metabolites%>%head()\n```\n:::\n\n\n### K-means Clustering\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# K means\nkm_fit <- kmeans(all_data[, -c(1:5)], centers = 2, iter.max = 300)\n\n# \"K-Means Clustering- Confusion matrix\")\n# table(all_data[,1],km_fit$cluster)\n\nmat_avgss <- matrix(nrow = 20, ncol = 2)\n\n# Average within the cluster sum of square\nprint(paste(\"Avg. Within sum of squares\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Avg. Within sum of squares\"\n```\n:::\n\n```{.r .cell-code}\nfor (i in (1:20)) {\n    km_fit <- kmeans(all_data[, -c(1:6)], centers = i, iter.max = 300)\n    mean_km <- mean(km_fit$withinss)\n    print(paste(\"K-Value\", i, \",Avg.within sum of squares\", round(mean_km, 2)))\n    mat_avgss[i, 1] <- i\n    mat_avgss[i, 2] <- mean_km\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"K-Value 1 ,Avg.within sum of squares 498092.66\"\n[1] \"K-Value 2 ,Avg.within sum of squares 235721.28\"\n[1] \"K-Value 3 ,Avg.within sum of squares 153580.64\"\n[1] \"K-Value 4 ,Avg.within sum of squares 113075.98\"\n[1] \"K-Value 5 ,Avg.within sum of squares 89447.07\"\n[1] \"K-Value 6 ,Avg.within sum of squares 73624.86\"\n[1] \"K-Value 7 ,Avg.within sum of squares 62460.44\"\n[1] \"K-Value 8 ,Avg.within sum of squares 54064.12\"\n[1] \"K-Value 9 ,Avg.within sum of squares 47499.77\"\n[1] \"K-Value 10 ,Avg.within sum of squares 42564.27\"\n[1] \"K-Value 11 ,Avg.within sum of squares 38390.33\"\n[1] \"K-Value 12 ,Avg.within sum of squares 35011.74\"\n[1] \"K-Value 13 ,Avg.within sum of squares 32084.77\"\n[1] \"K-Value 14 ,Avg.within sum of squares 29656.17\"\n[1] \"K-Value 15 ,Avg.within sum of squares 27499.88\"\n[1] \"K-Value 16 ,Avg.within sum of squares 25668.25\"\n[1] \"K-Value 17 ,Avg.within sum of squares 24056.25\"\n[1] \"K-Value 18 ,Avg.within sum of squares 22594.86\"\n[1] \"K-Value 19 ,Avg.within sum of squares 21266.45\"\n[1] \"K-Value 20 ,Avg.within sum of squares 20152.21\"\n```\n:::\n\n```{.r .cell-code}\nplot(mat_avgss[, 1], mat_avgss[, 2], type = \"o\", xlab = \"K_Value\", ylab = \"Avg. within sum of square\")\ntitle(\"Avg. within sum of squares vs. K-value\")\n```\n\n::: {.cell-output-display}\n![](mining_files/figure-html/unnamed-chunk-3-1.png){width=768}\n:::\n\n```{.r .cell-code}\nmat_varexp <- matrix(nrow = 20, ncol = 2)\n# Percentage of Variance explained\nprint(paste(\"Percent. variance explained\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Percent. variance explained\"\n```\n:::\n\n```{.r .cell-code}\nfor (i in (1:20)) {\n    km_fit <- kmeans(all_data[, -c(1:6)], centers = i, iter.max = 300)\n    var_exp <- km_fit$betweenss / km_fit$totss\n    print(paste(\"K-Value\", i, \",Percent var explained\", round(var_exp, 4)))\n    mat_varexp[i, 1] <- i\n    mat_varexp[i, 2] <- var_exp\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"K-Value 1 ,Percent var explained 0\"\n[1] \"K-Value 2 ,Percent var explained 0.0535\"\n[1] \"K-Value 3 ,Percent var explained 0.075\"\n[1] \"K-Value 4 ,Percent var explained 0.0903\"\n[1] \"K-Value 5 ,Percent var explained 0.1032\"\n[1] \"K-Value 6 ,Percent var explained 0.1152\"\n[1] \"K-Value 7 ,Percent var explained 0.1243\"\n[1] \"K-Value 8 ,Percent var explained 0.1298\"\n[1] \"K-Value 9 ,Percent var explained 0.1386\"\n[1] \"K-Value 10 ,Percent var explained 0.144\"\n[1] \"K-Value 11 ,Percent var explained 0.1534\"\n[1] \"K-Value 12 ,Percent var explained 0.1572\"\n[1] \"K-Value 13 ,Percent var explained 0.1616\"\n[1] \"K-Value 14 ,Percent var explained 0.1678\"\n[1] \"K-Value 15 ,Percent var explained 0.1707\"\n[1] \"K-Value 16 ,Percent var explained 0.1762\"\n[1] \"K-Value 17 ,Percent var explained 0.1813\"\n[1] \"K-Value 18 ,Percent var explained 0.1842\"\n[1] \"K-Value 19 ,Percent var explained 0.1889\"\n[1] \"K-Value 20 ,Percent var explained 0.1925\"\n```\n:::\n\n```{.r .cell-code}\nplot(mat_varexp[, 1], mat_varexp[, 2], type = \"o\", xlab = \"K_Value\", ylab = \"Percent Var explained\")\ntitle(\"Avg. within sum of squares vs. K-value\")\n```\n\n::: {.cell-output-display}\n![](mining_files/figure-html/unnamed-chunk-3-2.png){width=768}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n:::\n</div>\n\n<div class=\"tab-pane fade\" id=\"English\" role=\"tabpanel\" aria-labelledby=\"English-tab\">\n\n::: {#English .tab-pane .fade role=\"tabpanel\" aria-labelledby=\"English-tab\"}\n\n:::\n\n\n</div>\n\n\n\n\n",
    "supporting": [
      "mining_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../../site_libs/htmlwidgets-1.6.1/htmlwidgets.js\"></script>\r\n<script src=\"../../../site_libs/plotly-binding-4.10.1/plotly.js\"></script>\r\n<script src=\"../../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\r\n<script src=\"../../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\r\n<link href=\"../../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\r\n<link href=\"../../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\r\n<script src=\"../../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}