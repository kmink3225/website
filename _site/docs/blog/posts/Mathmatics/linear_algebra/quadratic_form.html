<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kwangmin Kim">
<meta name="dcterms.date" content="2023-04-02">
<meta name="description" content="template">

<title>Kwangmin Kim - Matrix Transformation (5) - Quadratic Form</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../">
<script src="../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../../.././images/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../../../index.html">
    <span class="navbar-title">Kwangmin Kim</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../docs/CV/index.html" rel="" target="">
 <span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../docs/projects/index.html" rel="" target="">
 <span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../docs/blog/index.html" rel="" target="">
 <span class="menu-text">Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../about.html" rel="" target="">
 <span class="menu-text">Me</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kmink3225" rel="" target=""><i class="bi bi-github" role="img" aria-label="Github">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/kwangmin-kim-a5241b200/" rel="" target=""><i class="bi bi-linkedin" role="img" aria-label="Linkedin">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../docs/blog/index.html" rel="" target=""><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text">Blog</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#quadratic-form" id="toc-quadratic-form" class="nav-link active" data-scroll-target="#quadratic-form"><span class="header-section-number">1</span> Quadratic Form</a>
  <ul class="collapse">
  <li><a href="#properties" id="toc-properties" class="nav-link" data-scroll-target="#properties"><span class="header-section-number">1.1</span> Properties</a></li>
  <li><a href="#positive-definite-matrix" id="toc-positive-definite-matrix" class="nav-link" data-scroll-target="#positive-definite-matrix"><span class="header-section-number">1.2</span> Positive Definite Matrix</a></li>
  <li><a href="#bilinear-form" id="toc-bilinear-form" class="nav-link" data-scroll-target="#bilinear-form"><span class="header-section-number">1.3</span> Bilinear Form</a></li>
  </ul></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples"><span class="header-section-number">2</span> Examples</a></li>
  <li><a href="#apllications" id="toc-apllications" class="nav-link" data-scroll-target="#apllications"><span class="header-section-number">3</span> Apllications</a>
  <ul class="collapse">
  <li><a href="#sum-of-squares" id="toc-sum-of-squares" class="nav-link" data-scroll-target="#sum-of-squares"><span class="header-section-number">3.1</span> Sum of Squares</a></li>
  <li><a href="#define-multivariate-distributions" id="toc-define-multivariate-distributions" class="nav-link" data-scroll-target="#define-multivariate-distributions"><span class="header-section-number">3.2</span> Define Multivariate Distributions</a></li>
  <li><a href="#optimization-problems" id="toc-optimization-problems" class="nav-link" data-scroll-target="#optimization-problems"><span class="header-section-number">3.3</span> Optimization Problems</a></li>
  <li><a href="#study-of-quadratic-behavior-systems" id="toc-study-of-quadratic-behavior-systems" class="nav-link" data-scroll-target="#study-of-quadratic-behavior-systems"><span class="header-section-number">3.4</span> Study of Quadratic Behavior Systems</a></li>
  <li><a href="#machine-learning" id="toc-machine-learning" class="nav-link" data-scroll-target="#machine-learning"><span class="header-section-number">3.5</span> Machine Learning</a></li>
  <li><a href="#finance" id="toc-finance" class="nav-link" data-scroll-target="#finance"><span class="header-section-number">3.6</span> Finance</a></li>
  <li><a href="#cryptography" id="toc-cryptography" class="nav-link" data-scroll-target="#cryptography"><span class="header-section-number">3.7</span> Cryptography</a></li>
  <li><a href="#variability-of-vector-x" id="toc-variability-of-vector-x" class="nav-link" data-scroll-target="#variability-of-vector-x"><span class="header-section-number">3.8</span> Variability of Vector, x</a></li>
  <li><a href="#pca" id="toc-pca" class="nav-link" data-scroll-target="#pca"><span class="header-section-number">3.9</span> PCA</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Matrix Transformation (5) - Quadratic Form</h1>
<p class="subtitle lead">the sum of squares, covariance matrix, and correlation matrix</p>
  <div class="quarto-categories">
    <div class="quarto-category">Mathematics</div>
  </div>
  </div>

<div>
  <div class="description">
    <p>template</p>
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Kwangmin Kim </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 2, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="quadratic-form" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="quadratic-form"><span class="header-section-number">1</span> Quadratic Form</h2>
<div id="def-quadratic" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1 (Quadratic Form) </strong></span>For a vector <span class="math inline">\(\mathbf{x} = [x_1,x_2,\ldots,x_n]^T\)</span>, the quadratic form is defined as</p>
<p><span class="math display">\[
Q(\mathbf{x}) = \mathbf{x}^T \mathbf{A} \mathbf{x}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{A}\)</span> is an <span class="math inline">\(n \times n\)</span> symmetric matrix.</p>
</div>
<p>Here, <span class="math inline">\(\mathbf{x}^T\)</span> represents the transpose of the vector <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{x}^T \mathbf{A} \mathbf{x}\)</span> represents the dot product of the vector <span class="math inline">\(\mathbf{x}\)</span> with itself after the transformation by the matrix <span class="math inline">\(\mathbf{A}\)</span>.</p>
<p>The quadratic form can be used to represent a quadratic equation using vectors and matrices. For example, let <span class="math inline">\(\mathbf{x} = [x_1,x_2]^T\)</span> and <span class="math inline">\(\mathbf{A}\)</span> be a <span class="math inline">\(2 \times 2\)</span> symmetric matrix given by:</p>
<p><span class="math display">\[
\mathbf A = \begin{bmatrix} 2&amp;1 \\ 1&amp;3 \end{bmatrix}
\]</span></p>
<p>Then, the quadratic form <span class="math inline">\(Q(\mathbf{x})\)</span> can be written as:</p>
<p><span class="math display">\[
\begin{align*}
\mathbf{Q}(\mathbf{x}) &amp;=
\begin{bmatrix} x_1 &amp; x_2
\end{bmatrix}
\begin{bmatrix}
2 &amp; 1 \\
1 &amp; 3
\end{bmatrix}
\begin{bmatrix}
x_1 \\ x_2
\end{bmatrix} \\
&amp;= \begin{bmatrix} 2x_1 + x_2 &amp; x_1 + 3x_2 \end{bmatrix}
\begin{bmatrix} x_1 \\ x_2 \end{bmatrix} \\
&amp;= 2x_1^2 + 2x_1x_2 + 3x_2^2
\end{align*}
\]</span></p>
<p>Here, we can see that the quadratic form can be represented as a polynomial function of degree 2 in the variables <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> with the coefficients given by the entries of the symmetric matrix <span class="math inline">\(\mathbf{A}\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Non-uniqueness
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that the matrix <span class="math inline">\(\mathbf{A}\)</span> of the quadratic form <span class="math inline">\(Q(\mathbf{x})\)</span> is not uniuqe if <span class="math inline">\(\mathbf{A}\)</span> is not symmetric. Different choices of <span class="math inline">\(\mathbf{A}\)</span> can give rise to the same quadratic form. For example, <span class="math inline">\(\mathbf B = \begin{bmatrix} 2&amp;1.5 \\ 0.5&amp;3 \end{bmatrix}\)</span> makes the <span class="math inline">\(\mathbf Q(\mathbf x) = 2x_1^2+2x_1x_2+3x_2^2\)</span></p>
<p><span class="math display">\[
\mathbf Q(\mathbf x) = \mathbf{x}^T \mathbf{B} \mathbf{x}=
\begin{bmatrix}
x_1 &amp; x_2
\end{bmatrix}
\begin{bmatrix}
2&amp;1.5 \\ 0.5&amp;3
\end{bmatrix}
\begin{bmatrix}
x_1 \\ x_2
\end{bmatrix}=2x_1^2+2x_1x_2+3x_2^2
\]</span></p>
<p>There are infinitely many cases that resulting in <span class="math inline">\(\mathbf Q(\mathbf x) = 2x_1^2+2x_1x_2+3x_2^2\)</span> with any combination of <span class="math inline">\(b_{12},b_{21}\)</span> such that <span class="math inline">\(b_{12} + b_{21} =2\)</span>.</p>
<p>Another example of <span class="math inline">\(\mathbf Q(\mathbf x)= \mathbf{x}^T \mathbf{A} \mathbf{x}= 4x_1^2+7x_1x_2+9x_2^2\)</span> gives the possible multiple <span class="math inline">\(\mathbf{B}\)</span> matrices such as <span class="math display">\[
\mathbf{B}_1 = \begin{bmatrix} 4&amp;4 \\ 3&amp;9 \end{bmatrix} \quad \mathbf{B}_2 = \begin{bmatrix} 4&amp;3.5 \\ 3.5&amp;9 \end{bmatrix} \quad \mathbf{B}_3 = \begin{bmatrix} 4&amp;1 \\ 6&amp;9 \end{bmatrix} \quad \mathbf{B}_4 = \begin{bmatrix} 4&amp;2 \\ 5&amp;9 \end{bmatrix} \quad \text{etc}
\]</span>.</p>
<p><strong>But there are several constraints that can be imposed on <span class="math inline">\(\mathbf{A}\)</span> to make it unique</strong>:</p>
<ul>
<li>Symmetric: If <span class="math inline">\(\mathbf{A}\)</span> is required to be symmetric, i.e., <span class="math inline">\(\mathbf{A} = \mathbf{A}^T\)</span>, then it can be shown that <span class="math inline">\(\mathbf{A}\)</span> is unique.
<ul>
<li>Suppose <span class="math inline">\(Q(\mathbf{x})=x_1^2+x_2^2+x_3^2\)</span>. Then the associated matrix is <span class="math inline">\(\mathbf{A}=\begin{bmatrix}1&amp;0&amp;0\\0&amp;1&amp;0\\0&amp;0&amp;1\end{bmatrix}\)</span>.</li>
</ul></li>
<li>Positive definite: If <span class="math inline">\(\mathbf{A}\)</span> is required to be positive definite, i.e., <span class="math inline">\(\mathbf{x}^T \mathbf{A} \mathbf{x} &gt; 0\)</span> for all nonzero vectors <span class="math inline">\(\mathbf{x}\)</span>, then it can be shown that <span class="math inline">\(\mathbf{A}\)</span> is unique.
<ul>
<li>Suppose <span class="math inline">\(Q(\mathbf{x})=2x_1^2+3x_2^2+4x_3^2+4x_1x_2-4x_1x_3+8x_2x_3\)</span>. Then the associated matrix is <span class="math inline">\(\mathbf{A}=\begin{bmatrix}2&amp;2&amp;-2\\2&amp;3&amp;4\\-2&amp;4&amp;4\end{bmatrix}\)</span>.</li>
</ul></li>
<li>Diagonal: If <span class="math inline">\(\mathbf{A}\)</span> is required to be diagonal, then it is unique up to the order of the diagonal elements.
<ul>
<li>Consider the quadratic form <span class="math inline">\(Q(\mathbf{x}) = x_1^2 - 4x_1x_2 + 4x_2^2 + 4x_3^2\)</span>. To express <span class="math inline">\(Q(\mathbf{x})\)</span> in the form of <span class="math inline">\(\mathbf{x}^T\mathbf{A}\mathbf{x}\)</span>, we first define the matrix <span class="math inline">\(\mathbf{A}\)</span> as <span class="math inline">\(\mathbf{A}=\begin{bmatrix}1&amp;-2&amp;0\\-2&amp;3&amp;0\\0&amp;0&amp;4\end{bmatrix}\)</span>. Then we have <span class="math inline">\(Q(\mathbf{x}) = \mathbf{x}^T \mathbf{A} \mathbf{x}=\begin{bmatrix}x_1&amp;x_2&amp;x_3\end{bmatrix}\begin{bmatrix}1&amp;-2&amp;0\\-2&amp;3&amp;0\\0&amp;0&amp;4\end{bmatrix}\begin{bmatrix}x_1\\x_2\\x_3\end{bmatrix}\)</span>. So, the matrix <span class="math inline">\(\mathbf{A}\)</span> is unique, and it is the one we defined above.</li>
</ul></li>
</ul>
<p>To find the symmetrtic matrix <span class="math inline">\(\mathbf{A}\)</span> among these candidates, pick one of the candidates matrices and conduct the following operation: <span class="math display">\[
\mathbf{A}=\frac{1}{2}(\mathbf{B}_i+\mathbf{B}_i^T)
\]</span></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">65</span>,<span class="dv">98</span>,<span class="dv">5</span>),<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>A<span class="ot">&lt;-</span><span class="fl">0.5</span><span class="sc">*</span>(B<span class="sc">+</span><span class="fu">t</span>(B))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">'B='</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "B="</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    6   98
[2,]   65    5</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">'A='</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "A="</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]  6.0 81.5
[2,] 81.5  5.0</code></pre>
</div>
</div>
</div>
</div>
<section id="properties" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="properties"><span class="header-section-number">1.1</span> Properties</h3>
<ul>
<li>Linearity: <span class="math inline">\(Q(a\mathbf{x} + b\mathbf{y}) = aQ(\mathbf{x}) + bQ(\mathbf{y})\)</span>, where <span class="math inline">\(a,b\)</span> are scalars and <span class="math inline">\(\mathbf{x},\mathbf{y}\)</span> are vectors.</li>
<li>Symmetry: <span class="math inline">\(Q(\mathbf{x}) = Q(\mathbf{x}^T)\)</span> for all vectors <span class="math inline">\(\mathbf{x}\)</span>.</li>
<li>Homogeneity: <span class="math inline">\(Q(k\mathbf{x}) = k^2 Q(\mathbf{x})\)</span> for all vectors <span class="math inline">\(\mathbf{x}\)</span> and scalar <span class="math inline">\(k\)</span>.</li>
<li>5 Types of Quadratic Forms
<ol type="1">
<li>Positive Definite: <span class="math inline">\(Q(\mathbf{x}) &gt; 0\)</span> for all nonzero vectors <span class="math inline">\(\mathbf{x}\)</span>.</li>
<li>Positive Semi-Definite: <span class="math inline">\(Q(\mathbf{x}) \geq 0\)</span> for all vectors <span class="math inline">\(\mathbf{x}\)</span>.</li>
<li>Negative Definite: <span class="math inline">\(Q(\mathbf{x}) &lt; 0\)</span> for all nonzero vectors <span class="math inline">\(\mathbf{x}\)</span>.</li>
<li>Negative Semi-Definite: <span class="math inline">\(Q(\mathbf{x}) \leq 0\)</span> for all vectors <span class="math inline">\(\mathbf{x}\)</span>.</li>
<li>Indefinite: <span class="math inline">\(Q(\mathbf{x})\)</span> takes both positive and negative values for some nonzero vector <span class="math inline">\(\mathbf{x}\)</span>.</li>
</ol></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>plot_quadratic_form<span class="ot">&lt;-</span><span class="cf">function</span>(formula){</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotFun</span>(formula,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x1.lim=</span><span class="fu">range</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x2.lim=</span><span class="fu">range</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">surface=</span><span class="cn">TRUE</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab=</span><span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab=</span><span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">zlab=</span><span class="fu">expression</span>(<span class="fu">Q</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>]))</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## PDM: positive definite matrix</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="do">## PSDM: positive semi-definite matrix</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="do">## NDM: negative definite matrix</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="do">## NSDM: negative semi-definite matrix</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="do">## IDM: indefinte matrix</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>PDM <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>PSDM <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>NDM <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>NSDM <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>IDM<span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co"># positive definite</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_quadratic_form</span>(x1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> x2<span class="sc">^</span><span class="dv">2</span> <span class="sc">~</span>x1<span class="sc">&amp;</span>x2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="quadratic_form_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># positive semi-definite</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_quadratic_form</span>(x1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>x1<span class="sc">*</span>x2<span class="sc">+</span>x2<span class="sc">^</span><span class="dv">2</span><span class="sc">~</span>x1 <span class="sc">&amp;</span>x2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="quadratic_form_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># negative definite</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_quadratic_form</span>(<span class="sc">-</span>x1<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> x2<span class="sc">^</span><span class="dv">2</span> <span class="sc">~</span>x1<span class="sc">&amp;</span>x2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="quadratic_form_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># negative semi-definite</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_quadratic_form</span>(<span class="sc">-</span>x1<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>x1<span class="sc">*</span>x2<span class="sc">-</span>x2<span class="sc">^</span><span class="dv">2</span><span class="sc">~</span>x1 <span class="sc">&amp;</span>x2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="quadratic_form_files/figure-html/unnamed-chunk-4-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># indefinite matrix</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_quadratic_form</span>(x1<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span>x2<span class="sc">^</span><span class="dv">2</span><span class="sc">~</span>x1 <span class="sc">&amp;</span>x2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="quadratic_form_files/figure-html/unnamed-chunk-4-5.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>all the <span class="math inline">\(a_{ii}\)</span> s has the same sign for the following cases
<ul>
<li>positive definite: except for f(x1,x2)= f(0,0) =0, all f(x1,x2) are positive.</li>
<li>semi-positive definite: f(x1,x2)= f(0,0),… , f(10,10) =0, the other all f(x1,x2) are negative.</li>
<li>negative definite: except for f(x1,x2)= f(0,0) =0, all f(x1,x2) are positive.</li>
<li>semi-negative definite: f(x1,x2)= f(0,0),… , f(10,10) =0, the other all f(x1,x2) are negative.</li>
</ul></li>
<li>indefinite: the graph has the saddle point</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># c(3,3,3,7)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_quadratic_form</span>(<span class="dv">3</span><span class="sc">*</span>x1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span><span class="dv">6</span><span class="sc">*</span>x1<span class="sc">*</span>x2<span class="sc">+</span><span class="dv">7</span><span class="sc">*</span>x2<span class="sc">^</span><span class="dv">2</span><span class="sc">~</span>x1 <span class="sc">&amp;</span>x2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="quadratic_form_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="how-to-tell-positive-definite-matrix-from-positive-semi-definite-matrix" class="level4" data-number="1.1.1">
<h4 data-number="1.1.1" class="anchored" data-anchor-id="how-to-tell-positive-definite-matrix-from-positive-semi-definite-matrix"><span class="header-section-number">1.1.1</span> How to Tell Positive Definite Matrix from Positive Semi-Definite Matrix?</h4>
<p>Eigen value decomposition makes it possible to tell a Positive Definite Matrix from a Positive Semi-Definite Matrix.</p>
<div id="thm-spectral" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (Spectral Theorem for Symmetric Matrices) </strong></span>A real symmetric matrix is positive definite if and only if all its eigenvalues are positive.</p>
</div>
<p>The result of eigen value decomposition are eigen values and eigen vectors. According to the types of the eigen values, we can determine what the matrix is:</p>
<ul>
<li>positive definite if the eigen values are all positive.</li>
<li>semi-positive definite if at least one of the eigen values is zero and the rest of them are all positive.</li>
<li>negative definite if the eigen values are all negative.</li>
<li>semi-negative definite if the eigen values are all negative and the rest of them are all negative.</li>
<li>indefinite if the eigen values has both signs +/-.</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>If eigen values are all positive and the matrix is positive definite, the matrix is invertible.</p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>A<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">7</span>), <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>eigen() decomposition
$values
[1] 8.605551 1.394449

$vectors
          [,1]       [,2]
[1,] 0.4718579 -0.8816746
[2,] 0.8816746  0.4718579</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(PDM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>eigen() decomposition
$values
[1] 1 1

$vectors
     [,1] [,2]
[1,]    0   -1
[2,]    1    0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(PSDM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>eigen() decomposition
$values
[1] 2 0

$vectors
          [,1]       [,2]
[1,] 0.7071068 -0.7071068
[2,] 0.7071068  0.7071068</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(NDM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>eigen() decomposition
$values
[1] -1 -1

$vectors
     [,1] [,2]
[1,]    1    0
[2,]    0    1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(NSDM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>eigen() decomposition
$values
[1]  0 -2

$vectors
           [,1]      [,2]
[1,] -0.7071068 0.7071068
[2,]  0.7071068 0.7071068</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(IDM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>eigen() decomposition
$values
[1]  1 -1

$vectors
     [,1] [,2]
[1,]   -1    0
[2,]    0   -1</code></pre>
</div>
</div>
</section>
</section>
<section id="positive-definite-matrix" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="positive-definite-matrix"><span class="header-section-number">1.2</span> Positive Definite Matrix</h3>
<p>A symmetric matrix <span class="math inline">\(\mathbf{A}\)</span> is positive definite if and only if the quadratic form <span class="math inline">\(f(\mathbf{x})=\mathbf{x}^T \mathbf{A} \mathbf{x}\)</span> is positive for all nonzero vectors <span class="math inline">\(\mathbf{x}\)</span>.</p>
<p>To see why this is true, consider the eigenvalue decomposition of <span class="math inline">\(\mathbf{A}\)</span>, which can be written as <span class="math inline">\(\mathbf{A} = \mathbf{Q} \Lambda \mathbf{Q}^T\)</span>, where <span class="math inline">\(\mathbf{Q}\)</span> is an orthogonal matrix and <span class="math inline">\(\Lambda\)</span> is a diagonal matrix containing the eigenvalues of <span class="math inline">\(\mathbf{A}\)</span>. Then, for any nonzero vector <span class="math inline">\(\mathbf{x}\)</span>, we have</p>
<p><span class="math display">\[
\begin{aligned}
\mathbf x^T \mathbf A \mathbf x&amp;=\mathbf x^T \mathbf Q \mathbf \Lambda \mathbf Q^T \mathbf x \quad (\because \text{diagonalization of } \mathbf A)\\
&amp;=(\mathbf x^T \mathbf Q)\mathbf \Lambda ( \mathbf Q^T\mathbf x)\\
&amp;=\sum_{i=1}^{n} \lambda_iy_i^2
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(y_i = (\mathbf{x}^T \mathbf{Q})_i\)</span> is the <span class="math inline">\(i\)</span> th coordinate (i.e., a scalar value that represents the position of a point or a vector relative to a chosen basis) of <span class="math inline">\(\mathbf{x}^T \mathbf{A}\)</span> and <span class="math inline">\(n\)</span> is the dimension of <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{A}\)</span>.</p>
<p>Note that since <span class="math inline">\(\mathbf{Q}\)</span> is orthogonal, we have <span class="math inline">\(\mathbf{Q}^T \mathbf{Q} = \mathbf{I}\)</span>, so <span class="math inline">\(y_i = \mathbf{q}_i^T \mathbf{x}\)</span>, where <span class="math inline">\(\mathbf{q}_i\)</span> is the <span class="math inline">\(i\)</span> th column of <span class="math inline">\(\mathbf{Q}\)</span>. Therefore, the quadratic form <span class="math inline">\(f(\mathbf{x}) = \mathbf{x}^T \mathbf{A} \mathbf{x}\)</span> can be written in terms of the eigenvalues of <span class="math inline">\(\mathbf{A}\)</span> and the coordinates of <span class="math inline">\(\mathbf{x}\)</span> with respect to the eigenvectors of <span class="math inline">\(\mathbf{A}\)</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Diagonalization
</div>
</div>
<div class="callout-body-container callout-body">
<p>Diagonalization is a process of finding a diagonal matrix <span class="math inline">\(\mathbf D\)</span> and an invertible matrix <span class="math inline">\(\mathbf P\)</span> such that <span class="math inline">\(\mathbf{P}^{-1}\mathbf{A}\mathbf{P} = \mathbf{D}\)</span>, where <span class="math inline">\(\mathbf A\)</span> is a square matrix. In other words, diagonalization is a way of representing a matrix as a diagonal matrix, which is a matrix with non-zero values only on its main diagonal.</p>
</div>
</div>
<p>Since <span class="math inline">\(\mathbf{A}\)</span> is positive definite, we have <span class="math inline">\(\lambda_i &gt; 0\)</span> for all <span class="math inline">\(i\)</span>, and so <span class="math inline">\(\sum_{i=1}^n \lambda_i y_i^2 &gt; 0\)</span> for all nonzero vectors <span class="math inline">\(\mathbf{x}\)</span>. Therefore, the quadratic form <span class="math inline">\(f(\mathbf{x})=\mathbf{x}^T \mathbf{A} \mathbf{x}\)</span> is positive for all nonzero vectors <span class="math inline">\(\mathbf{x}\)</span>, which implies that <span class="math inline">\(\mathbf{A}\)</span> is positive definite.</p>
<p>In other words, the positive definiteness of a symmetric matrix <span class="math inline">\(\mathbf{A}\)</span> is equivalent to the positivity of the associated quadratic form <span class="math inline">\(f(\mathbf{x})=\mathbf{x}^T \mathbf{A} \mathbf{x}\)</span> for all nonzero vectors <span class="math inline">\(\mathbf{x}\)</span>.</p>
<p>Therefore, a symmetric matrix, <span class="math inline">\(\mathbf A\)</span> is said to be positive definite if all of its eigenvalues are positive or equivalently, a symmetric matrix, <span class="math inline">\(\mathbf A\)</span> is positive definite if left-multiplying and right-multiplying it by the same vector, <span class="math inline">\(\mathbf x\)</span> always gives a positive number if <span class="math inline">\(\mathbf x^T \mathbf A \mathbf x\)</span></p>
</section>
<section id="bilinear-form" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="bilinear-form"><span class="header-section-number">1.3</span> Bilinear Form</h3>
<p>A quadratic form can be expressed as a bilinear form. In other words, a quadratic form can be written in terms of a bilinear form by defining a new matrix that is the sum of the matrix representing the quadratic form and its transpose.</p>
<div id="def-bilinear" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2 (Bilinear Form) </strong></span>Suppose we have a quadratic form defined as <span class="math inline">\(q(\mathbf{x}) = \mathbf{x}^T \mathbf{A} \mathbf{x}\)</span> where <span class="math inline">\(\mathbf{A}\)</span> is a symmetric matrix. Then, we can define a bilinear form as:</p>
<p><span class="math display">\[
b(\mathbf{x}, \mathbf{y}) = \frac{1}{2}(\mathbf{x}^T \mathbf{A} \mathbf{y} + \mathbf{y}^T \mathbf{A} \mathbf{x})
\]</span></p>
</div>
<p>Note that the factor of <span class="math inline">\(\frac{1}{2}\)</span> is introduced to avoid double-counting. It can be shown that the two forms are equivalent, in the sense that for any <span class="math inline">\(\mathbf{x}\)</span>, <span class="math inline">\(q(\mathbf{x}) = b(\mathbf{x}, \mathbf{x})\)</span>.</p>
<p>In other words, every quadratic form can be expressed as a bilinear form, and every symmetric bilinear form can be expressed as a quadratic form.</p>
</section>
</section>
<section id="examples" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="examples"><span class="header-section-number">2</span> Examples</h2>
</section>
<section id="apllications" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="apllications"><span class="header-section-number">3</span> Apllications</h2>
<section id="sum-of-squares" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="sum-of-squares"><span class="header-section-number">3.1</span> Sum of Squares</h3>
<p>The sum of squares of a vector <span class="math inline">\(\mathbf{x} = [x_1, x_2, \ldots, x_n]^T\)</span> can be represented as a quadratic form <span class="math inline">\(\mathbf{x}^T\mathbf{x}\)</span>. To see this, consider the sum of squares:</p>
<p><span class="math display">\[
\sum_{i=1}^{n} x_i^2 = x_1^2 + x_2^2 + \dots +x_n^2
\]</span></p>
<p>Now, we can write this in vector form as:</p>
<p><span class="math display">\[
\mathbf x^T \mathbf I \mathbf x =  \mathbf x^T \mathbf x = \begin{bmatrix} x_1 &amp; x_2 &amp; \dots &amp; x_n \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \\ \vdots \\ x_n \end{bmatrix}
\]</span></p>
<p>Therefore, the sum of squares can be represented as a quadratic form <span class="math inline">\(\mathbf{x}^T\mathbf{x}\)</span>.</p>
</section>
<section id="define-multivariate-distributions" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="define-multivariate-distributions"><span class="header-section-number">3.2</span> Define Multivariate Distributions</h3>
<section id="bivariate-distributions" class="level4" data-number="3.2.1">
<h4 data-number="3.2.1" class="anchored" data-anchor-id="bivariate-distributions"><span class="header-section-number">3.2.1</span> Bivariate Distributions</h4>
<p>Quadratic form is used in the power part of the pdf of a bivariate normal distribution: <span class="math display">\[
f(x_1,x_2)=\frac{1}{2\pi\sigma_{\mathbf{X_1}}\sigma_{\mathbf{X_2}}\sqrt{1-\rho^2}}\operatorname{exp}\left[ -\frac{1}{2(1-\rho^2)}\left(\frac{(x_1-\mu_{X_1})^2}{\sigma_{X_1}}-\frac{2\rho(x_1-\mu_{X_1})(x_1-\mu_{X_1})(x_2-\mu_{X_2})}{\sigma_{X_1}\sigma_{X_2}}+\frac{(x_2-\mu_{X_2})^2}{\sigma_{X_2}}\right) \right]
\]</span> where <span class="math inline">\(\mu_{X_1}, \mu_{X_2}\)</span> are the means of <span class="math inline">\(X, Y\)</span> respectively, <span class="math inline">\(\sigma_{X_1}, \sigma_{X_2}\)</span> are the standard deviations of <span class="math inline">\(X_1,X_2\)</span> respectively, and <span class="math inline">\(\rho\)</span> is the correlation coefficient <span class="math inline">\(X_1,X_2\)</span>.</p>
<p>The pdf is equivalent with the following matrix form:</p>
<p><span class="math display">\[
f(\mathbf{x})=\frac{1}{(2\pi)^{\frac{n}{2}}|\Sigma|^{\frac{1}{2}}}\operatorname{exp}\left[ -\frac{1}{2}(\mathbf{x}-\mathbf{\mu})^{T}\mathbf{\Sigma}^{-1}(\mathbf{x}-\mathbf{\mu})\right]
\]</span></p>
<p>where <span class="math inline">\((\mathbf{x}-\mathbf{\mu})^{T}\mathbf{\Sigma}^{-1}(\mathbf{x}-\mathbf{\mu})\)</span> is a quadratic form, <span class="math inline">\(\mathbf{x}\)</span> is a vector in <span class="math inline">\(\mathbb{R}^n\)</span>, <span class="math inline">\(\mathbf{\mu}\)</span> is a mean vector in <span class="math inline">\(\mathbb{R}^n\)</span>, and <span class="math inline">\(\mathbf{\Sigma}\)</span> is a covariance matrix.</p>
<p><span class="math display">\[
\mathbf{x}=
\begin{bmatrix}x_1 \\ x_2\end{bmatrix} \quad
\mathbf{\mu}=\begin{bmatrix}\mu_{x_1} \\ \mu_{x_2}\end{bmatrix} \quad
\mathbf{\Sigma}=\begin{bmatrix}
\sigma_{X_1}^2 &amp; \rho\sigma_{X_1}\sigma_{X_2}\\
\rho\sigma_{X_1}\sigma_{X_2} &amp; \sigma_{X_2}
\end{bmatrix}
\]</span>.</p>
<p>The quadratic form <span class="math inline">\(\mathbf{\sigma}\)</span> informs us of how data are distributed with means <span class="math inline">\(\mathbf{\mu}\)</span> and the covariance matrix <span class="math inline">\(\mathbf{\Sigma}\)</span>.</p>
<p><strong>Exmaple1</strong> <span class="math inline">\(2x_1^2+4x_2^2\)</span> can be represented as a quadratic form <span class="math inline">\(\begin{bmatrix}x_1 &amp; x_2\end{bmatrix}\begin{bmatrix}2&amp;0 \\0&amp;4\end{bmatrix}\begin{bmatrix}x_1 \\ x_2\end{bmatrix}\)</span>. The matrix <span class="math inline">\(\mathbf{A}\)</span> part is <span class="math inline">\(\begin{bmatrix}2&amp;0 \\0&amp;4\end{bmatrix}\)</span> and its inverse is <span class="math inline">\(\begin{bmatrix}2^{-1}&amp;0 \\0&amp;4^{-1}\end{bmatrix}\)</span>. Here, since the off diagonal entries are zeros, <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are independent. Then, the pdf is:</p>
<p><span class="math display">\[
f(x_1,x_2)=\frac{1}{2\pi\sigma_{\mathbf{X_1}}\sigma_{\mathbf{X_2}}}\operatorname{exp}\left[ -\frac{1}{2}\left(\frac{(x_1-\mu_{X_1})^2}{\sigma_{X_1}}+\frac{(x_2-\mu_{X_2})^2}{\sigma_{X_2}}\right) \right]
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The inverse of a diagonal matrix is the inverse of each entry</p>
</div>
</div>
<p><strong>Exmaple2</strong> <span class="math inline">\(9x_1^2+6x_1x_2+4x_2^2\)</span></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>mu1<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>mu2<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>sigma1<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>sigma2<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>rho<span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(sigma1<span class="sc">^</span><span class="dv">2</span>,rho<span class="sc">*</span>sigma1<span class="sc">*</span>sigma2,rho<span class="sc">*</span>sigma1<span class="sc">*</span>sigma2,sigma2<span class="sc">^</span><span class="dv">2</span>),<span class="dv">2</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dmvnorm</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">mean=</span>mu,<span class="at">sigma=</span>sigma) <span class="co"># a pdf value at (1,1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02592721</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1/((2*pi)*sqrt(det(sigma)))*exp(-0.5*t(c(1,1)-mu) %*% solve(sigma) %*% (c(1,1)-mu))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This value is the same as <span class="math inline">\(f(\mathbf{x})=\frac{1}{(2\pi)^{\frac{n}{2}}|\Sigma|^{\frac{1}{2}}}\operatorname{exp}\left[ -\frac{1}{2}(\mathbf{x}-\mathbf{\mu})^{T}\mathbf{\Sigma}^{-1}(\mathbf{x}-\mathbf{\mu})\right]=\)</span> 0.0259272</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotFun</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>sigma1<span class="sc">*</span>sigma2<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>))<span class="sc">*</span>((x1<span class="sc">-</span>mu1)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>sigma1<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(x2<span class="sc">-</span>mu2)<span class="sc">^</span><span class="dv">2-2</span><span class="sc">*</span>rho<span class="sc">*</span>(x1<span class="sc">-</span>mu1)<span class="sc">*</span>(x2<span class="sc">-</span>mu2))<span class="sc">/</span>(sigma1<span class="sc">*</span>sigma2))<span class="sc">~</span>x1 <span class="sc">&amp;</span> x2,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">mu1=</span><span class="dv">1</span>,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mu2=</span><span class="dv">2</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma1=</span><span class="dv">3</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma2=</span><span class="dv">2</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">rho=</span><span class="fl">0.5</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">x1.lim=</span><span class="fu">range</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>),</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">x2.lim=</span><span class="fu">range</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>),</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">surface=</span><span class="cn">TRUE</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab=</span><span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab=</span><span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">zlab=</span><span class="fu">expression</span>(<span class="fu">f</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>])))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="quadratic_form_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="multivariate-distributions" class="level4" data-number="3.2.2">
<h4 data-number="3.2.2" class="anchored" data-anchor-id="multivariate-distributions"><span class="header-section-number">3.2.2</span> Multivariate Distributions</h4>
</section>
</section>
<section id="optimization-problems" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="optimization-problems"><span class="header-section-number">3.3</span> Optimization Problems</h3>
<section id="quadratic-programming" class="level4" data-number="3.3.1">
<h4 data-number="3.3.1" class="anchored" data-anchor-id="quadratic-programming"><span class="header-section-number">3.3.1</span> Quadratic Programming</h4>
<p>Objective Functions, Constraints, or Penalty Terms</p>
</section>
</section>
<section id="study-of-quadratic-behavior-systems" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="study-of-quadratic-behavior-systems"><span class="header-section-number">3.4</span> Study of Quadratic Behavior Systems</h3>
<section id="harmonic-oscillators" class="level4" data-number="3.4.1">
<h4 data-number="3.4.1" class="anchored" data-anchor-id="harmonic-oscillators"><span class="header-section-number">3.4.1</span> Harmonic Oscillators</h4>
</section>
<section id="vibrating-systems." class="level4" data-number="3.4.2">
<h4 data-number="3.4.2" class="anchored" data-anchor-id="vibrating-systems."><span class="header-section-number">3.4.2</span> Vibrating Systems.</h4>
</section>
</section>
<section id="machine-learning" class="level3" data-number="3.5">
<h3 data-number="3.5" class="anchored" data-anchor-id="machine-learning"><span class="header-section-number">3.5</span> Machine Learning</h3>
<section id="cost-functions" class="level4" data-number="3.5.1">
<h4 data-number="3.5.1" class="anchored" data-anchor-id="cost-functions"><span class="header-section-number">3.5.1</span> Cost Functions</h4>
</section>
<section id="regularization-terms" class="level4" data-number="3.5.2">
<h4 data-number="3.5.2" class="anchored" data-anchor-id="regularization-terms"><span class="header-section-number">3.5.2</span> Regularization terms,</h4>
<p>Ridge Regression</p>
</section>
<section id="kernel-functions" class="level4" data-number="3.5.3">
<h4 data-number="3.5.3" class="anchored" data-anchor-id="kernel-functions"><span class="header-section-number">3.5.3</span> Kernel Functions</h4>
<p>SVM</p>
</section>
</section>
<section id="finance" class="level3" data-number="3.6">
<h3 data-number="3.6" class="anchored" data-anchor-id="finance"><span class="header-section-number">3.6</span> Finance</h3>
<p>Modeling risk and return in portfolio optimization and asset pricing models</p>
</section>
<section id="cryptography" class="level3" data-number="3.7">
<h3 data-number="3.7" class="anchored" data-anchor-id="cryptography"><span class="header-section-number">3.7</span> Cryptography</h3>
<p>quadratic sieve algorithm for integer factorization</p>
</section>
<section id="variability-of-vector-x" class="level3" data-number="3.8">
<h3 data-number="3.8" class="anchored" data-anchor-id="variability-of-vector-x"><span class="header-section-number">3.8</span> Variability of Vector, x</h3>
<p>The covariance matrix of a random vector <span class="math inline">\(\mathbf{x}\)</span> can be represented as a quadratic form in terms of the vector <span class="math inline">\(\mathbf{x}\)</span> and the matrix <span class="math inline">\(\mathbf{C}\)</span> as follows:</p>
<p><span class="math display">\[
\mathbf x^T \mathbf C \mathbf x
\]</span></p>
<p>where <span class="math inline">\(\mathbf{C}\)</span> is the covariance matrix. This expression is a quadratic form because it involves a quadratic polynomial in the elements of <span class="math inline">\(\mathbf{x}\)</span>.</p>
<p>In this representation, the diagonal elements of <span class="math inline">\(\mathbf{C}\)</span> correspond to the variances of the individual components of <span class="math inline">\(\mathbf{x}\)</span>, and the off-diagonal elements correspond to the covariances between the components. The expression <span class="math inline">\(\mathbf{x}^T \mathbf{C} \mathbf{x}\)</span> measures the variability of the random vector <span class="math inline">\(\mathbf{x}\)</span> in all possible directions, weighted by the covariances between the components.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The covariance matrix <span class="math inline">\(\mathbf{C}\)</span> measures the covariance between each pair of components of the random vector <span class="math inline">\(\mathbf{x}\)</span>. It is a matrix that summarizes the <strong>pairwise covariances</strong> between the components of <span class="math inline">\(\mathbf{x}\)</span>.</p>
<p>On the other hand, the quadratic form <span class="math inline">\(\mathbf{x}^T \mathbf{C} \mathbf{x}\)</span> measures the total variability of <span class="math inline">\(\mathbf{x}\)</span>, taking into account the covariances between <strong>all possible pairs of components</strong>.</p>
<p>It does this by weighting the contribution of each component to the overall variability by its covariance with every other component. So, while the covariance matrix <span class="math inline">\(\mathbf{C}\)</span> captures the pairwise covariances between the components of <span class="math inline">\(\mathbf{x}\)</span>, the quadratic form <span class="math inline">\(\mathbf{x}^T \mathbf{C} \mathbf{x}\)</span> captures the total variability of <span class="math inline">\(\mathbf{x}\)</span> in all directions.</p>
</div>
</div>
<p>Let’s take a simple example with a 2-dimensional random vector <span class="math inline">\(\mathbf{x}=[x_1, x_2]^T\)</span>. We can think of this random vector as representing data points in a 2D space. The covariance matrix <span class="math inline">\(\mathbf{C}\)</span> will capture the covariances between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>. Let’s say that the covariance matrix is given by:</p>
<p><span class="math display">\[
\mathbf C =\begin{bmatrix} \sigma_{x_1} &amp; \operatorname{Cov}(x_1,x_2) \\ \operatorname{Cov}(x_2,x_1) &amp; \sigma_{x_2} \end{bmatrix}
\]</span></p>
<p>where <span class="math inline">\(\sigma_{x_1}^2\)</span> and <span class="math inline">\(\sigma_{x_2}^2\)</span> are the variances of <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>, respectively, and <span class="math inline">\(\text{Cov}(x_1,x_2)\)</span> is their covariance.</p>
<p>Now, let’s consider the quadratic form <span class="math inline">\(\mathbf{x}^T \mathbf{C} \mathbf{x}\)</span>. This expression gives us a scalar value that measures the variability of the random vector <span class="math inline">\(\mathbf{x}\)</span> in all possible directions, weighted by the covariances between the components. We can see this geometrically by plotting the data points in the 2D space and drawing an ellipse that captures the variability of the data. The shape of the ellipse is determined by the eigenvalues and eigenvectors of the covariance matrix <span class="math inline">\(\mathbf{C}\)</span>.</p>
<p>To see this, let’s first rewrite the quadratic form as: <span class="math display">\[
\mathbf x^T \mathbf C \mathbf x = \sigma_{x_1}^2x_1^2 +2\operatorname{Cov}(x_1,x_2)x_1x_2+\sigma_{x_2}^2
\]</span></p>
<p>This is a quadratic equation in <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> and can be thought of as the equation of an ellipse centered at the origin by the determinant of the conic equation. The shape of the ellipse is determined by the coefficients of the quadratic terms, which are the variances and covariances in the covariance matrix <span class="math inline">\(\mathbf{C}\)</span>.</p>
<p>Now, let’s find the eigenvectors and eigenvalues of the covariance matrix <span class="math inline">\(\mathbf{C}\)</span>. The eigenvectors are the directions along which the data has the most variance, and the corresponding eigenvalues are the variances of the data along those directions.</p>
<p>Let’s assume that the eigenvalues of <span class="math inline">\(\mathbf{C}\)</span> are ordered such that <span class="math inline">\(\lambda_1 \geq \lambda_2\)</span>. Then, the eigenvectors <span class="math inline">\(\mathbf{v}_1\)</span> and <span class="math inline">\(\mathbf{v}_2\)</span> satisfy:</p>
<p><span class="math display">\[
\mathbf C \mathbf v_1 =\lambda_1\mathbf v_1 \text{  }
\mathbf C \mathbf v_2 =\lambda_2\mathbf v_2
\]</span></p>
<p>These equations can be rewritten as:</p>
<p><span class="math display">\[
\begin{equation}
\begin{bmatrix}
  \sigma_{x_1}^2 &amp; \text{Cov}(x_1,x_2)\\
  \text{Cov}(x_1,x_2) &amp; \sigma_{x_2}^2
\end{bmatrix}
\begin{bmatrix}
  v_{11}\\
  v_{21}
\end{bmatrix}
= \lambda_1
\begin{bmatrix}
v_{11}\\
v_{21}
\end{bmatrix}
\end{equation}
\]</span></p>
<p>This equation can be expanded as:</p>
<p><span class="math inline">\(\sigma_{x_1}^2 v_{11} + \text{Cov}(x_1,x_2) v_{21} = \lambda_1 v_{11}\)</span></p>
<p><span class="math inline">\(\text{Cov}(x_1,x_2) v_{11} + \sigma_{x_2}^2 v_{21} = \lambda_1 v_{21}\)</span></p>
<p>Now, let’s multiply the first equation by <span class="math inline">\(v_{11}\)</span> and the second equation by <span class="math inline">\(v_{21}\)</span>, and then subtract the second equation from the first:</p>
<p><span class="math inline">\((\sigma_{x_1}^2 - \lambda_1)v_{11}v_{21} + \text{Cov}(x_1,x_2)(v_{21}^2 - v_{11}^2) = 0\)</span></p>
<p>This can be rewritten as:</p>
<p><span class="math inline">\(\frac{v_{21}}{v_{11}} = \frac{\sigma_{x_1}^2 - \lambda_1}{\text{Cov}(x_1,x_2)} - \frac{v_{11}}{v_{21}}\)</span></p>
<p>Let <span class="math inline">\(t = \frac{v_{21}}{v_{11}}\)</span>. Then, we have:</p>
<p><span class="math inline">\(t^2 - \left(\frac{\sigma_{x_1}^2 + \sigma_{x_2}^2}{\text{Cov}(x_1,x_2)}\right)t + \frac{\lambda_1}{\text{Cov}(x_1,x_2)} = 0\)</span></p>
<p>This is a quadratic equation in <span class="math inline">\(t\)</span>, and its roots can be solved using the quadratic formula. The roots are:</p>
<p><span class="math inline">\(t_1 = \frac{\sigma_{x_1}^2 - \sigma_{x_2}^2 + \sqrt{(\sigma_{x_1}^2 - \sigma_{x_2}^2)^2 + 4\text{Cov}(x_1,x_2)^2}}{2\text{Cov}(x_1,x_2)}\)</span></p>
<p><span class="math inline">\(t_2 = \frac{\sigma_{x_1}^2 - \sigma_{x_2}^2 - \sqrt{(\sigma_{x_1}^2 - \sigma_{x_2}^2)^2 + 4\text{Cov}(x_1,x_2)^2}}{2\text{Cov}(x_1,x_2)}\)</span></p>
<p>Finally, the eigenvectors <span class="math inline">\(\mathbf{v}_1\)</span> and <span class="math inline">\(\mathbf{v}_2\)</span> are given by:</p>
<p><span class="math display">\[
\mathbf{v}_1 = \begin{bmatrix}1 \\ t_1 \end{bmatrix} \text{  }
\mathbf{v}_2 = \begin{bmatrix} 1 \\ t_2 \end{bmatrix}
\]</span></p>
<p>These eigenvectors define the principal components of the data, which are the orthogonal directions in the feature space along which the data varies the most.</p>
<p>Let’s apply this difference between <span class="math inline">\(\mathbf C= \operatorname{Cov(\mathbf X)}\)</span> and <span class="math inline">\(\mathbf x^T \mathbf{C} \mathbf x\)</span> or PCA to Iris dataset:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> load_iris</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the iris dataset</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> load_iris()</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> iris.data</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize the data</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>X_std <span class="op">=</span> scaler.fit_transform(X)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the covariance matrix</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>cov_matrix <span class="op">=</span> np.cov(X_std.T)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'C=Cov(X) =</span><span class="ch">\n</span><span class="sc">{</span>cov_matrix<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the eigenvalues and eigenvectors of the covariance matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>C=Cov(X) =
[[ 1.00671141 -0.11835884  0.87760447  0.82343066]
 [-0.11835884  1.00671141 -0.43131554 -0.36858315]
 [ 0.87760447 -0.43131554  1.00671141  0.96932762]
 [ 0.82343066 -0.36858315  0.96932762  1.00671141]]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>eigenvalues, eigenvectors <span class="op">=</span> np.linalg.eig(cov_matrix)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort the eigenvalues in descending order</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>sorted_indexes <span class="op">=</span> eigenvalues.argsort()[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>sorted_eigenvalues <span class="op">=</span> eigenvalues[sorted_indexes]</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>sorted_eigenvectors <span class="op">=</span> eigenvectors[:, sorted_indexes]</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Project the data onto the principal components</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>transformed_data <span class="op">=</span> X_std.dot(sorted_eigenvectors)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the PCA</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>ax.scatter(transformed_data[:, <span class="dv">0</span>], transformed_data[:, <span class="dv">1</span>], c<span class="op">=</span>iris.target)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'PC1'</span>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'PC2'</span>)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'PCA, Part of the Total Variance of Iris Data Explained by 2 PCs'</span>)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="quadratic_form_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This representation is useful in many statistical and machine learning applications, where the covariance matrix provides information about the variability and dependencies between different features or variables. For example, in principal component analysis (PCA), the covariance matrix is used to identify the directions of maximum variability in a dataset, which can be used to reduce the dimensionality of the data while retaining as much information as possible.</p>
</section>
<section id="pca" class="level3" data-number="3.9">
<h3 data-number="3.9" class="anchored" data-anchor-id="pca"><span class="header-section-number">3.9</span> PCA</h3>
<p>The principal components of a dataset can be obtained by finding the eigenvectors of the covariance matrix. In other words, we can express the covariance matrix as a quadratic form:</p>
<p><span class="math display">\[
\mathbf C = \mathbf x^T \mathbf A \mathbf x
\]</span></p>
<p>where <span class="math inline">\(\mathbf{x}\)</span> is a column vector of centered data, and <span class="math inline">\(\mathbf{A}\)</span> is a symmetric positive semi-definite matrix (the covariance matrix). Diagonalizing <span class="math inline">\(\mathbf{A}\)</span> gives us the eigenvalues and eigenvectors, which are used to transform the original data into a new coordinate system, where the first axis (the first principal component) corresponds to the direction of greatest variance, the second axis (the second principal component) corresponds to the direction of second greatest variance, and so on. This new coordinate system is called the principal component space.</p>
<p>In summary, PCA can be seen as a method for finding the principal components of a dataset by diagonalizing the covariance matrix, which can be expressed as a quadratic form.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>