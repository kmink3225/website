---
title: Transformation of Random Variables
subtitle: Transformation of Functions
description: | 
 
categories:
  - Statistics
author: Kwangmin Kim
date: 02/21/2023
draft: false
format: 
  html:
    toc: true
    number-sections: True
    code-fold: true
    page-layout: full
execute: 
  warning: false
  message: false
---

<ul class="nav nav-pills" id="language-tab" role="tablist">
  <li class="nav-item" role="presentation">
    <button class="nav-link active" id="Korean-tab" data-bs-toggle="tab" data-bs-target="#Korean" type="button" role="tab" aria-controls="Korean" aria-selected="true">Korean</button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link" id="English-tab" data-bs-toggle="tab" data-bs-target="#English" type="button" role="tab" aria-controls="knitr" aria-selected="false">English</button>
  </li>

<div class="tab-content" id="language-tabcontent">

<div class="tab-pane fade  show active" id="Korean" role="tabpanel" aria-labelledby="Korean-tab">

::: {#Korean .tab-pane .fade .show .active role="tabpanel" aria-labelledby="Korean-tab"}



## Trnasformation of Random Variables

### Introduction

확률 변수 2개 이상에 대한 확률 분포를 joint probability distribution (결합확률분포)라고 하는데 두 확률 변수 $X$ 와 $Y$ 의 관계에 대해서 규명해야 할 때가 있다. 예를 들어, X 와 Y의 높은 상관계수라든지 혹은 비선형적인 관계가 관찰될 때 그 관계가 수리적으로 모델링이 가능하고 한 확률 변수의 분포에 대한 정보를 알고있다면 미지의 다른 확률 변수의 분포가 추정가능해진다. 이 때 두 변수에 대한 관계 정도가 높으면 높을수록 추정이 쉬워진다.

이번 블로그에서는 주어진 확률 변수 $X$ 에 대해서 $X$ 의 pmf 혹은 pdf $f_x(x)$ 를 알고있을 때 확률 변수에 $X$ 에 적절한 함수의 변환을 적용해 확률 변수 $Y$ 를 $Y=u(X)$ 라는 관계식이 정의 가능할 때 $Y$ 의 pdf를 구하는 방법에 집중한다. 후에 MGF (Momment Generating Function)에 응용될 수 있는 개념으로 잘 정리할 필요가 있다. 

### Trnasformation of Discrete Random Variables

::: {#thm-discrete}

Discrete random variable $X$ 의 probability distribution이 $f_X(x)$ 이고  $X$ 와 $Y$ 사이에는 $Y=u(X)$ 라는 one-to-one relation이 성립될 때 $y=u(x)$ 를 유일한 $x$ 를 $y$ 에 대한 함수인 $x=w(y)$ 로 표현 가능할 때 $Y$ 의 확률 분포는 
$$
f_Y(y)=f_X(w(y))
$$ 
이다.  

:::

#### Example

* When it is a One-to-One relation

동전을 독립적으로 2번 던질 때, 확률 변수 $X$ 는 앞면이 나오는 수라고 했을 때, 확률 분포는 다음과 같다. 이 때 $Y=2x+1$ 라는 관계가 성립할 때 Y의 분포는 다음과 같다.

::: {#tbl-panel layout-ncol=2}

| $X$      |    0 |     1 |      2 |
|----------|:----:|:-----:|:------:|
| $P_X(X=x)$| $\frac{1}{4}$ | $\frac{2}{4}$ | $\frac{1}{4}$ |

: Probability Distribution of $X$ 

| $Y=2X+1$ |    1 |     3 |      5 |
|----------|:----:|:-----:|:------:|
| $P_Y(Y=y)$| $\frac{1}{4}$ | $\frac{2}{4}$ | $\frac{1}{4}$ |

: Probability Distribution of $Y=2X+1$

Exmaple: Transformation of Discrete Random Variable (One to One)
:::

* When it is not a One-to-One relation

동전을 독립적으로 2번 던질 때, 확률 변수 $X$ 는 앞면이 나오는 수가 짝수일 때, 확률 분포는 다음과 같다. 이 때 $Y=mod(X,2)$ 라는 관계가 성립할 때 Y의 분포는 다음과 같다.

::: {#tbl-panel layout-ncol=2}

| $X$      |    0 |     1 |      2 |
|----------|:----:|:-----:|:------:|
| $P_X(X=x)$| $\frac{1}{4}$ | $\frac{2}{4}$ | $\frac{1}{4}$ |

: Probability Distribution of $X$

| $Y=mod(x,2)$ |    0 |     1 |
|----------|:----:|:-----:|
| $P_Y(Y=y)$| $\frac{2}{4}$ | $\frac{2}{4}$ |

: Probability Distribution of $Y=2X+1$

Exmaple: Transformation of Discrete Random Variable (Not One to One)
:::

위의 예시와 같이 두 확률 변수가 one to one 관계일 때는 확률분포가 그대로 유지되어서 쉽게 변환된 확률 변수의 분포가 추정가능하지만 one to one 관계가 아닐 경우 확률 분포가 바뀌게 된다.

### Trnasformation of Joint Discrete Random Variables

::: {#thm-discrete_joint}

Two discrete random variable $X_1$ 과 $X_2$ 의 joint probability distribution이 $f(x_1,x_2)$ 이고  $(x_1,x_2)$ 와 $(y_1,y_2)$ 가 one-to-one relation이 성립될 때 $y_1=u_1(x_1,x_2)$ 와 $y_2=u_2(x_1,x_2)$ 를 유일한 $x_1=w_1(y_1,y_2)$ 와 $x_2=w_2(y_1,y_2)$ 의 함수로 표현 가능할 때 $Y_1=u_1(X_1,X_2)$ 와 $Y_2=u_2(X_1,X_2)$ 로 정의되는 새로운 확률변수 $Y_1$ 과 $Y_2$ 의 joint probability distribution는 
$$
f_Y(y_1.y_2)=f_X(w_1(y_1,y_2),w_2(y_1,y_2))
$$ 
이다.  

:::










### Trnasformation of Continuous Random Variables

::: {#thm-continuous}

continuous random variable $X$ 의 probability distribution이 $f_X(x)$ 이고 $X$ 와 $Y$ 사이에는 $Y=u(X)$ 라는 one-to-one relation이 성립될 때 $y=u(x)$ 를 유일한 $x$ 를 $y$ 에 대한 함수인 $x=w(y)$ 로 표현 가능할 때 Y의 확률 분포는 
$$
f_Y(y)=f_X(w(y))|J|
$$ 
이다. ($J=w'(y)$, called 'Jacobian')
:::


#### Example

* Transformation of Linear Function 

When two random variables X and Y has the relation, $Y=aX+b$ $(a\ne 0)$,   
what is $f_Y(y)$?

**By Theorem**

$$
\begin{aligned}
  Y&=u(X)=aX+b\\
  y&=u(x)=ax+b\\
  x&=w(y)=\frac{y-b}{a}\\
  f_Y(y)&=f_X(w(y))|J|=f_X(\frac{y-b}{a})|J|\\
        &=f_X(\frac{y-b}{a})|w'(y)|\\
        &=f_X(\frac{y-b}{a})|\frac{1}{a}|\\
        &=\frac{f_X(\frac{y-b}{a})}{|a|}\\
\end{aligned}
$$

**By Definition**

:::: {.columns}

::: {.column width="50%"}
* $a>0$
$$
\begin{aligned}
  F_Y(Y)&=P_Y(Y\le y)\\
        &=P_Y(aX+b\le y)\\
        &=P_Y(X\le \frac{y-b}{a})\\
        &=F_X(\frac{y-b}{a})\\
  F'_Y(Y)&=\frac{d}{dx}F_X(\frac{y-b}{a})\\
         &=f_X(\frac{y-b}{a})\frac{1}{a}\\
\end{aligned}
$$

:::

::: {.column width="50%"}
* $a\le 0$
$$
\begin{aligned}
  F_Y(Y)&=P_Y(Y\le y)\\
        &=P_Y(aX+b\le y)\\
        &=P_Y(X> \frac{y-b}{a})\\
        &=1-F_X(\frac{y-b}{a})\\
  F'_Y(Y)&=\frac{d}{dx}(1-F_X(\frac{y-b}{a}))\\
         &=-f_X(\frac{y-b}{a})\frac{1}{a}\\  
\end{aligned}
$$
:::

$$
\therefore f_Y(y)=\frac{f_X(\frac{y-b}{a})}{|a|}
$$

::::

```{python}
import numpy as np
import matplotlib.pyplot as plt

x = np.linspace(-10, 20, 1000)
y = 2*x+1
y2 = x/2+1

fig, ax = plt.subplots()


ax.axhline(y=0, color='k')
ax.axvline(x=0, color='k')
ax.grid(True, which='both')

ax.plot(x,y,color='black',label=r'$y=2x+1$')
ax.plot(x,y2,color='red',label=r'$y=\frac{1}{2}x+1$')
ax.set_aspect(1)
ax.set_title("Transformation of Random Variables")
ax.set_xlabel("x-axis")
ax.set_ylabel("y-axis")

plt.legend(shadow=True, loc=(-0.5, 1.1), handlelength=1.5, fontsize=8)
plt.show()

```

위의 그림을 보면 두 확률 변수 X와 Y의 관계가 X의 특정 구간에 대응되는 Y의 구간이 같다고 했을 때 Y의 확률 밀도는 X를 b만큼 이동한 확률 밀도의 a 배가 된다. 
예를 들어, 위의 그래프의 경우, $y = 2x+1$ $(a>1)$ 일 때 $f_X(0<X<10)$ 는 $f_Y(1<Y<21)$ 의 density가 2배가 되는 것을 관찰 할 수 있다. 반대로, $y = \frac{1}{2}x+1$ $(a\le 1)$ 일 때 $f_X(0<X<10)$ 는 $f_Y(1<Y<6)$


### Trnasformation of Joint Continuous Random Variables

::: {#thm-continuous_joint}

Two continuous random variable $X_1$ 과 $X_2$ 의 joint probability distribution이 $f(x_1,x_2)$ 이고  $(x_1,x_2)$ 와 $(y_1,y_2)$ 가 one-to-one relation이 성립될 때 $y_1=u_1(x_1,x_2)$ 와 $y_2=u_2(x_1,x_2)$ 를 유일한 $x_1=w_1(y_1,y_2)$ 와 $x_2=w_2(y_1,y_2)$ 의 함수로 표현 가능할 때 $Y_1=u_1(X_1,X_2)$ 와 $Y_2=u_2(X_1,X_2)$ 로 정의되는 새로운 확률변수 $Y_1$ 과 $Y_2$ 의 joint probability distribution는 
$$
g(y_1.y_2)=f(w_1(y_1,y_2),w_2(y_1,y_2)) |J|
$$ 
이다.  
여기서, 
$$
\begin{aligned}
  |J|=|
  \begin{bmatrix}
  \frac{\partial x_1}{\partial y_1}&\frac{\partial x_1}{\partial y_2}\\
  \frac{\partial x_2}{\partial y_1}&\frac{\partial x_2}{\partial y_2}\\
  \end{bmatrix}| = | \begin{bmatrix}
  \frac{\partial w_1(y_1,y_2)}{\partial y_1}&\frac{\partial w_1(y_1,y_2)}{\partial y_2}\\
  \frac{\partial w_2(y_1,y_2)}{\partial y_1}&\frac{\partial w_2(y_1,y_2)}{\partial y_2}\\
  \end{bmatrix} |
\end{aligned}
$$
called 'the determinant of jacobian matrix'

:::

#### Example

* 예제

연속확률변수  $X_1$ 과 $X_2$ 는 결합확률분포 
$$ 
f(x_1,x_2)=
  \begin{cases}
    4x_1x_2, & \text{if  } 0<x_1<1,& 0< x_2 <1 \\ 
    0, & \text{otherwise}
  \end{cases}
$$ 
일 때, $Y_1=X_1^2$ 과 $Y_2=X_1X_2$ 의 결합확률 분포를 구하여라.

* Solution

$$
\begin{aligned}
y_1&=u_1(x_1,x_2)= x_1^2\\
y_2&=u_2(x_1,x_2)= x_1x_2\\
x_1&=w_1(y_1,y_2)= \sqrt{y_1} & (y_1>0)\\
x_2&=w_2(y_1,y_2)= \frac{y_2}{x_1} = \frac{y_2}{\sqrt{y_1}}  & (y_1>0)\\
g(y_1.y_2)&=f(w_1(y_1,y_2),w_2(y_1,y_2))|J|\\
g(y_1.y_2)&=f(w_1(y_1,y_2),w_2(y_1,y_2))|J|\\
          &=4\sqrt{y_1}\frac{y_2}{\sqrt{y_1}}\frac{1}{2y_1}\\
          &=\begin{cases}
          \frac{2y_2}{y_1} & \text{if  } y_2^2<y_1<1, \text{  } 0<y_2<1\\
          0 & \text{otherwise}
          \end{cases}\\
          |J|&=|
          \begin{bmatrix}
          \frac{\partial x_1}{\partial y_1}&\frac{\partial x_1}{\partial y_2}\\
          \frac{\partial x_2}{\partial y_1}&\frac{\partial x_2}{\partial y_2}\\
          \end{bmatrix}|\\
           &=|
          \begin{bmatrix}
          \frac{1}{2\sqrt{y_1}}&0\\
          y_2(-\frac{1}{2}y_1^{\frac{-3}{2}})&\frac{1}{\sqrt{y_1}}\\
          \end{bmatrix}|\\
          &=\frac{1}{2y_1}
\end{aligned}
$$ 

:::

</div>



## Blog Guide Map Link

* [Statistics Blog](../guide_map/index.qmd)
* [Engineering Blog](../../Engineering/guide_map/index.qmd)
* [Deep Learning Blog](../../DL/guide_map/index.qmd)
* [Machine Learning Blog](../../ML/guide_map/index.qmd)
* [Mathematics Blog](../../Mathmatics/guide_map/index.qmd)
* [Patent Blog](../../Patent/guide_map/index.qmd)
* [Validation Blog](../../Validation/guide_map/index.qmd)



